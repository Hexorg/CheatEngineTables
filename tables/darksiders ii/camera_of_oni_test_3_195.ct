<?xml version="1.0" encoding="utf-8"?>
<CheatTable CheatEngineTableVersion="18">
  <CheatEntries>
    <CheatEntry>
      <ID>2878</ID>
      <Description>"      Camera of Oni"</Description>
      <Options moManualExpandCollapse="1"/>
      <LastState Value="" Activated="0" RealAddress="00000000"/>
      <Color>8A9C0C</Color>
      <GroupHeader>1</GroupHeader>
      <CheatEntries>
        <CheatEntry>
          <ID>3131</ID>
          <Description>"Oni Evil Aiming"</Description>
          <Options moHideChildren="1" moBindActivation="1" moManualExpandCollapse="1"/>
          <LastState Value="" Activated="0" RealAddress="00000000"/>
          <Color>0000CC</Color>
          <GroupHeader>1</GroupHeader>
          <CheatEntries>
            <CheatEntry>
              <ID>3149</ID>
              <Description>"                                                 Hold L1 &amp; Tap R3 to Switch"</Description>
              <Options moHideChildren="1" moManualExpandCollapse="1"/>
              <LastState Value="" Activated="0" RealAddress="00000000"/>
              <Color>0EB80A</Color>
              <GroupHeader>1</GroupHeader>
              <CheatEntries>
                <CheatEntry>
                  <ID>3191</ID>
                  <Description>"                                                 Hold R2 to Zoom In            "</Description>
                  <LastState Value="" Activated="0" RealAddress="00000000"/>
                  <Color>60A3DF</Color>
                  <GroupHeader>1</GroupHeader>
                </CheatEntry>
                <CheatEntry>
                  <ID>3133</ID>
                  <Description>"Side Switch Current "</Description>
                  <LastState Value="??" Activated="0" RealAddress="00000000"/>
                  <Color>C07212</Color>
                  <VariableType>Float</VariableType>
                  <Address>SideSwitch+c</Address>
                </CheatEntry>
                <CheatEntry>
                  <ID>3145</ID>
                  <Description>"Speed of Side Switch"</Description>
                  <LastState Value="??" Activated="0" RealAddress="00000000"/>
                  <Color>C1116D</Color>
                  <VariableType>Float</VariableType>
                  <Address>Camera_Mov_Rate</Address>
                </CheatEntry>
                <CheatEntry>
                  <ID>3142</ID>
                  <Description>"Aim Mode Zoom"</Description>
                  <LastState Value="??" Activated="0" RealAddress="00000000"/>
                  <Color>8E9A38</Color>
                  <VariableType>Float</VariableType>
                  <Address>Aim_Mode_Zoom</Address>
                </CheatEntry>
                <CheatEntry>
                  <ID>3143</ID>
                  <Description>"Aim Mode L2 Zoom"</Description>
                  <LastState Value="??" Activated="0" RealAddress="00000000"/>
                  <Color>6D3A98</Color>
                  <VariableType>Float</VariableType>
                  <Address>Aim_Mode_Zoom+4</Address>
                </CheatEntry>
              </CheatEntries>
            </CheatEntry>
            <CheatEntry>
              <ID>3148</ID>
              <Description>"Individual Scripts"</Description>
              <Options moHideChildren="1" moBindActivation="1" moManualExpandCollapse="1"/>
              <LastState Value="" Activated="0" RealAddress="00000000"/>
              <Color>C0C0C0</Color>
              <GroupHeader>1</GroupHeader>
              <CheatEntries>
                <CheatEntry>
                  <ID>3132</ID>
                  <Description>"Aim_Side_Switcher                               "</Description>
                  <LastState Activated="0"/>
                  <Color>808080</Color>
                  <VariableType>Auto Assembler Script</VariableType>
                  <AssemblerScript>{ Game   : Darksiders2.exe
  Version: 
  Date   : 2015-12-24
  Author : Akuma

  This script does blah blah blah
}

[ENABLE]

aobscanmodule(Resident_Evil_Style_Switcher,Darksiders2.exe,80 BD 9E 0A 00 00 00) // should be unique
alloc(newmem,$1000,"Darksiders2.exe"+1E4B02)

alloc(Aim_Mode_Stat,8)
registersymbol(Aim_Mode_Stat)

alloc(SideSwitch,16)
registersymbol(SideSwitch)




label(code)
label(Side_Switch_Load)
label(Switch_Sides_Check)
label(Switch_Sides)
label(zero_return)
label(originalcode)
label(return)



SideSwitch:
dd (float)-1


SideSwitch+C:
dd (float)-67



                    //Rax is DMA Camera //Rbp is Input/Death
newmem:
code:
//  cmp byte ptr [rbp+00000a99],01
//   je return
  mov [Aim_Mode_Stat],rax

  jmp Side_Switch_Load

Side_Switch_Load:
//  movss xmm14,[rax+3c]
  movss xmm14,[SideSwitch+C]
  movss [SideSwitch+4],xmm14
  movss xmm13,[SideSwitch+4]
  movss [rax+3c],xmm13
  cmp byte ptr [rbp+00000a9b],01          // compare for L1 held
   je Switch_Sides_Check
    jne originalcode

Switch_Sides_Check:
  cmp byte ptr [rbp+00000A9e],01
   je Switch_Sides
    jne zero_return


Switch_Sides:
   movss xmm14,[rax+3c]
   mulss xmm14,[SideSwitch]
   movss [SideSwitch+4],xmm14
   movss [SideSwitch+C],xmm14
    jmp return


zero_return:
 cmp [SideSwitch+8],0            // needed to retain aim mode
  jmp return

originalcode:
  cmp byte ptr [rbp+00000A9E],00
  jmp return

Resident_Evil_Style_Switcher:
  jmp code
  nop
  nop
return:
registersymbol(Resident_Evil_Style_Switcher)

[DISABLE]

Resident_Evil_Style_Switcher:
  db 80 BD 9E 0A 00 00 00

unregistersymbol(Resident_Evil_Style_Switcher)
dealloc(newmem)


dealloc(Aim_Mode_Stat)
unregistersymbol(Aim_Mode_Stat)

dealloc(SideSwitch)
unregistersymbol(SideSwitch)

{
// ORIGINAL CODE - INJECTION POINT: "Darksiders2.exe"+1E4B02

"Darksiders2.exe"+1E4AD2: 44 89 61 08              -  mov [rcx+08],r12d
"Darksiders2.exe"+1E4AD6: 48 8B 01                 -  mov rax,[rcx]
"Darksiders2.exe"+1E4AD9: BA 01 00 00 00           -  mov edx,00000001
"Darksiders2.exe"+1E4ADE: FF 10                    -  call qword ptr [rax]
"Darksiders2.exe"+1E4AE0: 48 85 ED                 -  test rbp,rbp
"Darksiders2.exe"+1E4AE3: 0F 84 47 01 00 00        -  je Darksiders2.exe+1E4C30
"Darksiders2.exe"+1E4AE9: 48 8B 46 40              -  mov rax,[rsi+40]
"Darksiders2.exe"+1E4AED: F3 0F 10 35 5F 26 44 01  -  movss xmm6,[Darksiders2.exe+1627154]
"Darksiders2.exe"+1E4AF5: 80 B8 A0 00 00 00 00     -  cmp byte ptr [rax+000000A0],00
"Darksiders2.exe"+1E4AFC: 0F 85 B8 00 00 00        -  jne Darksiders2.exe+1E4BBA
// ---------- INJECTING HERE ----------
"Darksiders2.exe"+1E4B02: 80 BD 9E 0A 00 00 00     -  cmp byte ptr [rbp+00000A9E],00
// ---------- DONE INJECTING  ----------
"Darksiders2.exe"+1E4B09: 74 17                    -  je Darksiders2.exe+1E4B22
"Darksiders2.exe"+1E4B0B: 0F 28 D6                 -  movaps xmm2,xmm6
"Darksiders2.exe"+1E4B0E: 0F 28 CE                 -  movaps xmm1,xmm6
"Darksiders2.exe"+1E4B11: 48 8B 4E 38              -  mov rcx,[rsi+38]
"Darksiders2.exe"+1E4B15: E8 DA 42 0F 00           -  call Darksiders2.exe+2D8DF4
"Darksiders2.exe"+1E4B1A: 84 C0                    -  test al,al
"Darksiders2.exe"+1E4B1C: 0F 85 3A FF FF FF        -  jne Darksiders2.exe+1E4A5C
"Darksiders2.exe"+1E4B22: 48 8D 94 24 80 00 00 00  -  lea rdx,[rsp+00000080]
"Darksiders2.exe"+1E4B2A: E8 8D 27 2E 00           -  call Darksiders2.exe+4C72BC
"Darksiders2.exe"+1E4B2F: 90                       -  nop 
}
</AssemblerScript>
                </CheatEntry>
                <CheatEntry>
                  <ID>3141</ID>
                  <Description>"Aim_Mode_Zoom"</Description>
                  <LastState Activated="0"/>
                  <Color>808080</Color>
                  <VariableType>Auto Assembler Script</VariableType>
                  <AssemblerScript>{ Game   : Darksiders2.exe
  Version: 
  Date   : 2015-12-24
  Author : Akuma

  This script does blah blah blah
}

[ENABLE]
//code from here to '[DISABLE]' will be used to enable the cheat

 
 
aobscanmodule(Aim_Mode_Zoom_ret,Darksiders2.exe,F3 0F 10 40 38 F3 0F 5C C1) // should be unique
alloc(newmem,$1000,"Darksiders2.exe"+1E6A61)

alloc(Aim_Mode_Zoom,8)
registersymbol(Aim_Mode_Zoom)

label(code)
label(Load_Button)
label(Aim_In_Zoom)
Label(Default_Zoom)
label(End_Option)
label(return)

Aim_Mode_Zoom:
dd (float)200

Aim_Mode_Zoom+4:
dd (float)30

newmem:

code:
Load_Button:
   mov r13,[Death_Stat]
   mov r13,[r13+170]
   movss xmm15,[SideSwitch+C]
    cmp byte ptr [r13+00000a99],01          // compare for L2 held
    je Aim_In_Zoom
     Jne Default_Zoom



Aim_In_Zoom:
  movss xmm0,[Aim_Mode_Zoom+4]
//  mov  [Side_Switch_Aimed],1
   jmp End_Option



Default_Zoom:
  movss xmm0,[Aim_Mode_Zoom]
//  mov  [Side_Switch_Aimed],0
   jmp End_Option



End_Option:
  mov r13,00000000FFFFFFFF
   jmp return

Aim_Mode_Zoom_ret:
  jmp code
return:
registersymbol(Aim_Mode_Zoom_ret)

[DISABLE]
//code from here till the end of the code will be used to disable the cheat
Aim_Mode_Zoom_ret:
  db F3 0F 10 40 38

unregistersymbol(Aim_Mode_Zoom_ret)
dealloc(newmem)

dealloc(Aim_Mode_Zoom)
unregistersymbol(Aim_Mode_Zoom)

{
// ORIGINAL CODE - INJECTION POINT: "Darksiders2.exe"+1E6A61

"Darksiders2.exe"+1E6A2C: F3 0F 59 C3              -  mulss xmm0,xmm3
"Darksiders2.exe"+1E6A30: F3 0F 58 C2              -  addss xmm0,xmm2
"Darksiders2.exe"+1E6A34: F3 0F 10 17              -  movss xmm2,[rdi]
"Darksiders2.exe"+1E6A38: F3 0F 11 81 C0 00 00 00  -  movss [rcx+000000C0],xmm0
"Darksiders2.exe"+1E6A40: F3 0F 10 40 40           -  movss xmm0,[rax+40]
"Darksiders2.exe"+1E6A45: F3 0F 5C C1              -  subss xmm0,xmm1
"Darksiders2.exe"+1E6A49: F3 0F 59 C3              -  mulss xmm0,xmm3
"Darksiders2.exe"+1E6A4D: F3 0F 58 C1              -  addss xmm0,xmm1
"Darksiders2.exe"+1E6A51: F3 0F 10 89 C8 00 00 00  -  movss xmm1,[rcx+000000C8]
"Darksiders2.exe"+1E6A59: F3 0F 11 81 C4 00 00 00  -  movss [rcx+000000C4],xmm0
// ---------- INJECTING HERE ----------
"Darksiders2.exe"+1E6A61: F3 0F 10 40 38           -  movss xmm0,[rax+38]
// ---------- DONE INJECTING  ----------
"Darksiders2.exe"+1E6A66: F3 0F 5C C1              -  subss xmm0,xmm1
"Darksiders2.exe"+1E6A6A: F3 0F 59 C3              -  mulss xmm0,xmm3
"Darksiders2.exe"+1E6A6E: F3 0F 58 C1              -  addss xmm0,xmm1
"Darksiders2.exe"+1E6A72: F3 0F 11 81 C8 00 00 00  -  movss [rcx+000000C8],xmm0
"Darksiders2.exe"+1E6A7A: F3 0F 5C 50 64           -  subss xmm2,[rax+64]
"Darksiders2.exe"+1E6A7F: 0F 57 C0                 -  xorps xmm0,xmm0
"Darksiders2.exe"+1E6A82: 0F 2F C2                 -  comiss xmm0,xmm2
"Darksiders2.exe"+1E6A85: 76 07                    -  jna Darksiders2.exe+1E6A8E
"Darksiders2.exe"+1E6A87: 0F 57 15 22 0F 44 01     -  xorps xmm2,[Darksiders2.exe+16279B0]
"Darksiders2.exe"+1E6A8E: F3 0F 59 15 1E FE 43 01  -  mulss xmm2,[Darksiders2.exe+16268B4]
}
</AssemblerScript>
                </CheatEntry>
                <CheatEntry>
                  <ID>3144</ID>
                  <Description>"Aim Mode Switch Rate"</Description>
                  <LastState Activated="0"/>
                  <Color>808080</Color>
                  <VariableType>Auto Assembler Script</VariableType>
                  <AssemblerScript>{ Game   : Darksiders2.exe
  Version: 
  Date   : 2015-12-24
  Author : Akuma

  This script does blah blah blah
}

[ENABLE]

aobscanmodule(Camera_Mov_Rate_ret,Darksiders2.exe,F3 0F 10 40 3C F3 0F 5C) // should be unique
alloc(newmem,$1000,"Darksiders2.exe"+1E6A23)


alloc(Camera_Mov_Rate,24)
registersymbol(Camera_Mov_Rate)

alloc(Camera_Mov_Rate_Side,24)
registersymbol(Camera_Mov_Rate_Side)

alloc(Camera_Swing_Rate,16)
registersymbol(Camera_Swing_Rate)

label(code)
label(return)

Camera_Mov_Rate:
dd (float)5.3854159265




newmem:

code:
  movss xmm0,[rax+3C]             // loads game zoom
  movss [Camera_Mov_Rate+4],xmm3   //default
  mulss xmm3,[Camera_Mov_Rate]    // new value
  movss [Camera_Mov_Rate+8],xmm3
  movss [Camera_Mov_Rate+C],xmm2       // visible transition
  jmp return

Camera_Mov_Rate_ret:
  jmp code
return:
registersymbol(Camera_Mov_Rate_ret)

[DISABLE]

Camera_Mov_Rate_ret:
  db F3 0F 10 40 3C

unregistersymbol(Camera_Mov_Rate_ret)
dealloc(newmem)

dealloc(Camera_Mov_Rate)
unregistersymbol(Camera_Mov_Rate)

dealloc(Camera_Mov_Rate_Side)
unregistersymbol(Camera_Mov_Rate_Side)

dealloc(Camera_Swing_Rate)
unregistersymbol(Camera_Swing_Rate)


{
// ORIGINAL CODE - INJECTION POINT: "Darksiders2.exe"+1E6A23

"Darksiders2.exe"+1E69F0: 48 89 5C 24 08           -  mov [rsp+08],rbx
"Darksiders2.exe"+1E69F5: 57                       -  push rdi
"Darksiders2.exe"+1E69F6: 48 83 EC 20              -  sub rsp,20
"Darksiders2.exe"+1E69FA: 48 8B 41 40              -  mov rax,[rcx+40]
"Darksiders2.exe"+1E69FE: F3 0F 10 91 C0 00 00 00  -  movss xmm2,[rcx+000000C0]
"Darksiders2.exe"+1E6A06: 0F 28 D9                 -  movaps xmm3,xmm1
"Darksiders2.exe"+1E6A09: F3 0F 10 89 C4 00 00 00  -  movss xmm1,[rcx+000000C4]
"Darksiders2.exe"+1E6A11: 48 8D B9 CC 00 00 00     -  lea rdi,[rcx+000000CC]
"Darksiders2.exe"+1E6A18: 48 8B D9                 -  mov rbx,rcx
"Darksiders2.exe"+1E6A1B: F3 0F 59 1D ED 00 44 01  -  mulss xmm3,[Darksiders2.exe+1626B10]
// ---------- INJECTING HERE ----------
"Darksiders2.exe"+1E6A23: F3 0F 10 40 3C           -  movss xmm0,[rax+3C]
// ---------- DONE INJECTING  ----------
"Darksiders2.exe"+1E6A28: F3 0F 5C C2              -  subss xmm0,xmm2
"Darksiders2.exe"+1E6A2C: F3 0F 59 C3              -  mulss xmm0,xmm3
"Darksiders2.exe"+1E6A30: F3 0F 58 C2              -  addss xmm0,xmm2
"Darksiders2.exe"+1E6A34: F3 0F 10 17              -  movss xmm2,[rdi]
"Darksiders2.exe"+1E6A38: F3 0F 11 81 C0 00 00 00  -  movss [rcx+000000C0],xmm0
"Darksiders2.exe"+1E6A40: F3 0F 10 40 40           -  movss xmm0,[rax+40]
"Darksiders2.exe"+1E6A45: F3 0F 5C C1              -  subss xmm0,xmm1
"Darksiders2.exe"+1E6A49: F3 0F 59 C3              -  mulss xmm0,xmm3
"Darksiders2.exe"+1E6A4D: F3 0F 58 C1              -  addss xmm0,xmm1
"Darksiders2.exe"+1E6A51: F3 0F 10 89 C8 00 00 00  -  movss xmm1,[rcx+000000C8]
}
</AssemblerScript>
                </CheatEntry>
                <CheatEntry>
                  <ID>3134</ID>
                  <Description>"Debug Aim"</Description>
                  <Options moHideChildren="1" moManualExpandCollapse="1"/>
                  <LastState Value="" Activated="0" RealAddress="00000000"/>
                  <Color>C0C0C0</Color>
                  <GroupHeader>1</GroupHeader>
                  <CheatEntries>
                    <CheatEntry>
                      <ID>3150</ID>
                      <Description>"Side Switch"</Description>
                      <Options moHideChildren="1" moManualExpandCollapse="1"/>
                      <LastState Value="" Activated="0" RealAddress="00000000"/>
                      <Color>80000008</Color>
                      <GroupHeader>1</GroupHeader>
                      <CheatEntries>
                        <CheatEntry>
                          <ID>3135</ID>
                          <Description>"Aim Mode Camera Offset Game Write Back"</Description>
                          <LastState Value="??" Activated="0" RealAddress="00000000"/>
                          <Color>724D86</Color>
                          <VariableType>Float</VariableType>
                          <Address>Camera_Start</Address>
                          <Offsets>
                            <Offset>3C</Offset>
                            <Offset>40</Offset>
                            <Offset>180</Offset>
                          </Offsets>
                        </CheatEntry>
                        <CheatEntry>
                          <ID>3136</ID>
                          <Description>"SideSwitch Math Flip "</Description>
                          <LastState Value="??" Activated="0" RealAddress="00000000"/>
                          <Color>008000</Color>
                          <VariableType>Float</VariableType>
                          <Address>SideSwitch</Address>
                        </CheatEntry>
                        <CheatEntry>
                          <ID>3137</ID>
                          <Description>"Loaded Game Value to do Math Flip"</Description>
                          <LastState Value="??" Activated="0" RealAddress="00000000"/>
                          <Color>000080</Color>
                          <VariableType>Float</VariableType>
                          <Address>SideSwitch+4</Address>
                        </CheatEntry>
                        <CheatEntry>
                          <ID>3138</ID>
                          <Description>"Aim Mode Pointer"</Description>
                          <Options moManualExpandCollapse="1"/>
                          <LastState Value="" Activated="0" RealAddress="00000000"/>
                          <Color>000080</Color>
                          <GroupHeader>1</GroupHeader>
                          <CheatEntries>
                            <CheatEntry>
                              <ID>3139</ID>
                              <Description>"Aim _Mode_Stat_Start"</Description>
                              <LastState Value="??" Activated="0" RealAddress="00000000"/>
                              <ShowAsHex>1</ShowAsHex>
                              <Color>80000008</Color>
                              <VariableType>4 Bytes</VariableType>
                              <Address>Aim_Mode_Stat</Address>
                            </CheatEntry>
                            <CheatEntry>
                              <ID>3140</ID>
                              <Description>"Aim _Mode_Offset"</Description>
                              <LastState Value="??" Activated="0" RealAddress="00000000"/>
                              <Color>80000008</Color>
                              <VariableType>Float</VariableType>
                              <Address>Aim_Mode_Stat</Address>
                              <Offsets>
                                <Offset>3C</Offset>
                              </Offsets>
                            </CheatEntry>
                          </CheatEntries>
                        </CheatEntry>
                      </CheatEntries>
                    </CheatEntry>
                    <CheatEntry>
                      <ID>3151</ID>
                      <Description>"Speed"</Description>
                      <Options moHideChildren="1" moManualExpandCollapse="1"/>
                      <LastState Value="" Activated="0" RealAddress="00000000"/>
                      <Color>80000008</Color>
                      <GroupHeader>1</GroupHeader>
                      <CheatEntries>
                        <CheatEntry>
                          <ID>3146</ID>
                          <Description>"Camera_Mov_Rate_Default"</Description>
                          <LastState Value="??" Activated="0" RealAddress="00000000"/>
                          <Color>80000008</Color>
                          <VariableType>Float</VariableType>
                          <Address>Camera_Mov_Rate+4</Address>
                        </CheatEntry>
                        <CheatEntry>
                          <ID>3147</ID>
                          <Description>"Camera_Mov_Rate_Changed"</Description>
                          <LastState Value="??" Activated="0" RealAddress="00000000"/>
                          <Color>80000008</Color>
                          <VariableType>Float</VariableType>
                          <Address>Camera_Mov_Rate+8</Address>
                        </CheatEntry>
                      </CheatEntries>
                    </CheatEntry>
                  </CheatEntries>
                </CheatEntry>
              </CheatEntries>
            </CheatEntry>
            <CheatEntry>
              <ID>3185</ID>
              <Description>"________________                                Resident Evil Style End                   __________________________"</Description>
              <LastState Value="" Activated="0" RealAddress="00000000"/>
              <Color>DDA58C</Color>
              <GroupHeader>1</GroupHeader>
            </CheatEntry>
          </CheatEntries>
        </CheatEntry>
        <CheatEntry>
          <ID>3173</ID>
          <Description>"Oni Telescope"</Description>
          <Options moBindActivation="1" moManualExpandCollapse="1"/>
          <LastState Value="" Activated="0" RealAddress="00000000"/>
          <Color>FF409F</Color>
          <GroupHeader>1</GroupHeader>
          <CheatEntries>
            <CheatEntry>
              <ID>3190</ID>
              <Description>"                                                          Hold L1  &amp;  Tap  Dpad Up "</Description>
              <LastState Value="" Activated="0" RealAddress="00000000"/>
              <Color>0EB80A</Color>
              <GroupHeader>1</GroupHeader>
            </CheatEntry>
            <CheatEntry>
              <ID>3184</ID>
              <Description>"Extra Zoom Level's"</Description>
              <Options moManualExpandCollapse="1"/>
              <LastState Value="" Activated="0" RealAddress="00000000"/>
              <Color>80000008</Color>
              <GroupHeader>1</GroupHeader>
              <CheatEntries>
                <CheatEntry>
                  <ID>3181</ID>
                  <Description>"Base Level Zoom"</Description>
                  <LastState Value="??" Activated="0" RealAddress="00000000"/>
                  <Color>E14D2D</Color>
                  <VariableType>Float</VariableType>
                  <Address>Oni_Zoom_Add+4</Address>
                </CheatEntry>
                <CheatEntry>
                  <ID>3182</ID>
                  <Description>"Level 2 Zoom"</Description>
                  <LastState Value="??" Activated="0" RealAddress="00000000"/>
                  <Color>E32BC4</Color>
                  <VariableType>Float</VariableType>
                  <Address>Oni_Zoom_Add+8</Address>
                </CheatEntry>
                <CheatEntry>
                  <ID>3183</ID>
                  <Description>"Level 3 Zoom"</Description>
                  <LastState Value="??" Activated="0" RealAddress="00000000"/>
                  <Color>3232DC</Color>
                  <VariableType>Float</VariableType>
                  <Address>Oni_Zoom_Add+C</Address>
                </CheatEntry>
              </CheatEntries>
            </CheatEntry>
            <CheatEntry>
              <ID>3188</ID>
              <Description>"Individual Injection Scripts"</Description>
              <Options moBindActivation="1" moManualExpandCollapse="1"/>
              <LastState Value="" Activated="0" RealAddress="00000000"/>
              <Color>C0C0C0</Color>
              <GroupHeader>1</GroupHeader>
              <CheatEntries>
                <CheatEntry>
                  <ID>3169</ID>
                  <Description>"DPad Up Input Oni Telescope"</Description>
                  <LastState Activated="0"/>
                  <Color>9CC6EB</Color>
                  <VariableType>Auto Assembler Script</VariableType>
                  <AssemblerScript>{ Game   : Darksiders2.exe
  Version: 
  Date   : 2016-01-10
  Author : Akuma

  This script does blah blah blah
}

[ENABLE]

aobscanmodule(D_Pad_UP_ret,Darksiders2.exe,48 8B CB FF 90 88 04 00 00 0F) // should be unique
alloc(newmem,$1000,"Darksiders2.exe"+4C0222)

alloc(Dpad_Up_Tap,8)
registersymbol(Dpad_Up_Tap)

alloc(Oni_Zoom_Level,8)
registersymbol(Oni_Zoom_Level)

label(code)
label(Dpad)
label(Write_Dpad_Up)
label(Write_Dpad_Up_Off)
label(Write_Dpad_Up_Seal_off)
label(Reset_Oni_Zoom)
label(originalcode)
label(return)

Oni_Zoom_Level:
db 01


newmem:
code:
  cmp byte ptr [rbx+00000a9b],01          // compare for L1 held
   je Dpad
    jmp originalcode




Dpad:
  cmp [Oni_Zoom_Level],4
    je Reset_Oni_Zoom

  cmp [Dpad_Up_Tap+4],1
   je Write_Dpad_Up_Off

  cmp byte ptr [rbx+00000Aa1],01
   je Write_Dpad_Up
    jne originalcode

Write_Dpad_Up:
  mov [Dpad_Up_Tap],1
  add [Oni_Zoom_Level],1
  mov [Dpad_Up_Tap+4],1
   jmp originalcode



Write_Dpad_Up_Off:
  mov [Dpad_Up_Tap],0
  cmp byte ptr [rbx+00000Aa1],00
   je Write_Dpad_Up_Seal_off
   // je to timer before retap available here
    jmp originalcode

Write_Dpad_Up_Seal_off:
//    write compare for mov distance reached here if all else fails



  mov [Dpad_Up_Tap+4],0
     jmp originalcode


Reset_Oni_Zoom:
 mov [Oni_Zoom_Level],0
 mov [Dpad_Up_Tap+4],0
 mov [Dpad_Up_Tap],0
  jmp originalcode






originalcode:
  mov rcx,rbx
  call qword ptr [rax+00000488]
  jmp return

D_Pad_UP_ret:
  jmp code
  nop
  nop
  nop
  nop
return:
registersymbol(D_Pad_UP_ret)

[DISABLE]

D_Pad_UP_ret:
  db 48 8B CB FF 90 88 04 00 00

unregistersymbol(D_Pad_UP_ret)
dealloc(newmem)

dealloc(Dpad_Up_Tap)
unregistersymbol(Dpad_Up_Tap)

dealloc(Oni_Zoom_Level)
unregistersymbol(Oni_Zoom_Level)

{
// ORIGINAL CODE - INJECTION POINT: "Darksiders2.exe"+4C0222

"Darksiders2.exe"+4C0204: 4C 8D 34 C7              -  lea r14,[rdi+rax*8]
"Darksiders2.exe"+4C0208: EB 0D                    -  jmp Darksiders2.exe+4C0217
"Darksiders2.exe"+4C020A: 48 8B 0F                 -  mov rcx,[rdi]
"Darksiders2.exe"+4C020D: 48 83 C7 08              -  add rdi,08
"Darksiders2.exe"+4C0211: 48 8B 01                 -  mov rax,[rcx]
"Darksiders2.exe"+4C0214: FF 50 70                 -  call qword ptr [rax+70]
"Darksiders2.exe"+4C0217: 0F 28 CE                 -  movaps xmm1,xmm6
"Darksiders2.exe"+4C021A: 49 3B FE                 -  cmp rdi,r14
"Darksiders2.exe"+4C021D: 75 EB                    -  jne Darksiders2.exe+4C020A
"Darksiders2.exe"+4C021F: 48 8B 03                 -  mov rax,[rbx]
// ---------- INJECTING HERE ----------
"Darksiders2.exe"+4C0222: 48 8B CB                 -  mov rcx,rbx
"Darksiders2.exe"+4C0225: FF 90 88 04 00 00        -  call qword ptr [rax+00000488]
// ---------- DONE INJECTING  ----------
"Darksiders2.exe"+4C022B: 0F 28 CE                 -  movaps xmm1,xmm6
"Darksiders2.exe"+4C022E: 48 8B CB                 -  mov rcx,rbx
"Darksiders2.exe"+4C0231: E8 9E F8 1F 00           -  call Darksiders2.exe+6BFAD4
"Darksiders2.exe"+4C0236: F3 0F 10 83 00 04 00 00  -  movss xmm0,[rbx+00000400]
"Darksiders2.exe"+4C023E: F3 0F 10 0D BA 65 16 01  -  movss xmm1,[Darksiders2.exe+1626800]
"Darksiders2.exe"+4C0246: 0F 2F C1                 -  comiss xmm0,xmm1
"Darksiders2.exe"+4C0249: 76 1F                    -  jna Darksiders2.exe+4C026A
"Darksiders2.exe"+4C024B: F3 0F 5C C6              -  subss xmm0,xmm6
"Darksiders2.exe"+4C024F: F3 0F 11 83 00 04 00 00  -  movss [rbx+00000400],xmm0
"Darksiders2.exe"+4C0257: 0F 2F C8                 -  comiss xmm1,xmm0
}
</AssemblerScript>
                  <CheatEntries>
                    <CheatEntry>
                      <ID>3170</ID>
                      <Description>"D-Pad Up Tap"</Description>
                      <LastState Value="??" Activated="0" RealAddress="00000000"/>
                      <Color>A9EA9D</Color>
                      <VariableType>4 Bytes</VariableType>
                      <Address>DPad_Up_Tap</Address>
                    </CheatEntry>
                    <CheatEntry>
                      <ID>3171</ID>
                      <Description>"D-Pad Up Held"</Description>
                      <LastState Value="??" Activated="0" RealAddress="00000000"/>
                      <Color>9ADCED</Color>
                      <VariableType>4 Bytes</VariableType>
                      <Address>DPad_Up_Tap+4</Address>
                    </CheatEntry>
                    <CheatEntry>
                      <ID>3172</ID>
                      <Description>"Oni Zoom Level"</Description>
                      <LastState Value="??" Activated="0" RealAddress="00000000"/>
                      <Color>ED9AD0</Color>
                      <VariableType>4 Bytes</VariableType>
                      <Address>Oni_Zoom_Level</Address>
                    </CheatEntry>
                  </CheatEntries>
                </CheatEntry>
                <CheatEntry>
                  <ID>3174</ID>
                  <Description>"Oni_Zoom_Adjuster"</Description>
                  <LastState Activated="0"/>
                  <Color>EC9BE3</Color>
                  <VariableType>Auto Assembler Script</VariableType>
                  <AssemblerScript>{ Game   : Darksiders2.exe
  Version: 
  Date   : 2016-01-10
  Author : Akuma

  This script does blah blah blah
}

[ENABLE]

aobscanmodule(Oni_Zoom_Adjuster_ret,Darksiders2.exe,0F 28 CE 48 8B CB E8 9E) // should be unique
alloc(newmem,$1000,"Darksiders2.exe"+4C022B)


alloc(Oni_Zoom_Add,24)
registersymbol(Oni_Zoom_Add)


label(code)
LABEL(Base_Zoom)
label(Lv2_Zoom)
label(Lv3_Zoom)
label(Oni_Zoom)
label(originalcode)
label(return)

newmem:
code:
  cmp [Oni_Zoom_Level],1
   je Base_Zoom
  cmp [Oni_Zoom_Level],2
   je Lv2_Zoom
  cmp [Oni_Zoom_Level],3
   je Lv3_Zoom
     jmp Oni_Zoom              // redundant but my toggle script is not polished




Oni_Zoom_Add+4:
dd (float)50

Oni_Zoom_Add+8:
dd (float)180

Oni_Zoom_Add+C:
dd (float)320




Base_Zoom:
  movss xmm15,[Oni_Zoom_Add+4]
   jmp Oni_Zoom



Lv2_Zoom:
  movss xmm15,[Oni_Zoom_Add+8]
   jmp Oni_Zoom




Lv3_Zoom:
  movss xmm15,[Oni_Zoom_Add+C]
   jmp Oni_Zoom


Oni_Zoom:
  movss [Oni_Zoom_Add],xmm15
   jmp originalcode








originalcode:
  movaps xmm1,xmm6
  mov rcx,rbx
  jmp return

Oni_Zoom_Adjuster_ret:
  jmp code
  nop
return:
registersymbol(Oni_Zoom_Adjuster_ret)

[DISABLE]

Oni_Zoom_Adjuster_ret:
  db 0F 28 CE 48 8B CB

unregistersymbol(Oni_Zoom_Adjuster_ret)
dealloc(newmem)

dealloc(Oni_Zoom_Add)
unregistersymbol(Oni_Zoom_Add)


{
// ORIGINAL CODE - INJECTION POINT: "Darksiders2.exe"+4C022B

"Darksiders2.exe"+4C0214: FF 50 70                 -  call qword ptr [rax+70]
"Darksiders2.exe"+4C0217: 0F 28 CE                 -  movaps xmm1,xmm6
"Darksiders2.exe"+4C021A: 49 3B FE                 -  cmp rdi,r14
"Darksiders2.exe"+4C021D: 75 EB                    -  jne Darksiders2.exe+4C020A
"Darksiders2.exe"+4C021F: 48 8B 03                 -  mov rax,[rbx]
"Darksiders2.exe"+4C0222: E9 D9 FD B0 FF           -  jmp 13FFD0000
"Darksiders2.exe"+4C0227: 90                       -  nop 
"Darksiders2.exe"+4C0228: 90                       -  nop 
"Darksiders2.exe"+4C0229: 90                       -  nop 
"Darksiders2.exe"+4C022A: 90                       -  nop 
// ---------- INJECTING HERE ----------
"Darksiders2.exe"+4C022B: 0F 28 CE                 -  movaps xmm1,xmm6
"Darksiders2.exe"+4C022E: 48 8B CB                 -  mov rcx,rbx
// ---------- DONE INJECTING  ----------
"Darksiders2.exe"+4C0231: E8 9E F8 1F 00           -  call Darksiders2.exe+6BFAD4
"Darksiders2.exe"+4C0236: F3 0F 10 83 00 04 00 00  -  movss xmm0,[rbx+00000400]
"Darksiders2.exe"+4C023E: F3 0F 10 0D BA 65 16 01  -  movss xmm1,[Darksiders2.exe+1626800]
"Darksiders2.exe"+4C0246: 0F 2F C1                 -  comiss xmm0,xmm1
"Darksiders2.exe"+4C0249: 76 1F                    -  jna Darksiders2.exe+4C026A
"Darksiders2.exe"+4C024B: F3 0F 5C C6              -  subss xmm0,xmm6
"Darksiders2.exe"+4C024F: F3 0F 11 83 00 04 00 00  -  movss [rbx+00000400],xmm0
"Darksiders2.exe"+4C0257: 0F 2F C8                 -  comiss xmm1,xmm0
"Darksiders2.exe"+4C025A: 72 0E                    -  jb Darksiders2.exe+4C026A
"Darksiders2.exe"+4C025C: 44 89 BB 00 04 00 00     -  mov [rbx+00000400],r15d
}
</AssemblerScript>
                  <CheatEntries>
                    <CheatEntry>
                      <ID>3175</ID>
                      <Description>"Final Added Zoom"</Description>
                      <LastState Value="??" Activated="0" RealAddress="00000000"/>
                      <Color>EEAC99</Color>
                      <VariableType>Float</VariableType>
                      <Address>Oni_Zoom_Add</Address>
                    </CheatEntry>
                  </CheatEntries>
                </CheatEntry>
                <CheatEntry>
                  <ID>3178</ID>
                  <Description>"Oni Zoom Injection"</Description>
                  <LastState Activated="0"/>
                  <Color>CA99EE</Color>
                  <VariableType>Auto Assembler Script</VariableType>
                  <AssemblerScript>{ Game   : Darksiders2.exe
  Version: 
  Date   : 2016-01-10
  Author : Akuma

  This script does blah blah blah
}

[ENABLE]

aobscanmodule(Final_Oni_Zoom_Add_ret,Darksiders2.exe,F3 44 0F 58 9B B8 01 00 00) // should be unique
alloc(newmem,$1000,"Darksiders2.exe"+19D65A)

label(code)
label(return)

newmem:

code:
  addss xmm11,[Oni_Zoom_Add]    //upper limit
//  addss xmm0,[Oni_Zoom_Add]
  addss xmm10,[Oni_Zoom_Add]       //Lower Limit

  jmp return

Final_Oni_Zoom_Add_ret:
  jmp code
  nop
  nop
  nop
  nop
return:
registersymbol(Final_Oni_Zoom_Add_ret)

[DISABLE]

Final_Oni_Zoom_Add_ret:
  db F3 44 0F 58 9B B8 01 00 00

unregistersymbol(Final_Oni_Zoom_Add_ret)
dealloc(newmem)

{
// ORIGINAL CODE - INJECTION POINT: "Darksiders2.exe"+19D65A

"Darksiders2.exe"+19D61E: 44 0F 28 D0                 -  movaps xmm10,xmm0
"Darksiders2.exe"+19D622: F3 44 0F 58 93 B8 01 00 00  -  addss xmm10,[rbx+000001B8]
"Darksiders2.exe"+19D62B: E8 F4 3C 00 00              -  call Darksiders2.exe+1A1324
"Darksiders2.exe"+19D630: F3 0F 10 1F                 -  movss xmm3,[rdi]
"Darksiders2.exe"+19D634: 44 0F 28 D8                 -  movaps xmm11,xmm0
"Darksiders2.exe"+19D638: F3 0F 5C 9B 50 01 00 00     -  subss xmm3,[rbx+00000150]
"Darksiders2.exe"+19D640: F3 0F 10 57 04              -  movss xmm2,[rdi+04]
"Darksiders2.exe"+19D645: F3 0F 10 4F 08              -  movss xmm1,[rdi+08]
"Darksiders2.exe"+19D64A: F3 0F 5C 8B 58 01 00 00     -  subss xmm1,[rbx+00000158]
"Darksiders2.exe"+19D652: F3 0F 5C 93 54 01 00 00     -  subss xmm2,[rbx+00000154]
// ---------- INJECTING HERE ----------
"Darksiders2.exe"+19D65A: F3 44 0F 58 9B B8 01 00 00  -  addss xmm11,[rbx+000001B8]
// ---------- DONE INJECTING  ----------
"Darksiders2.exe"+19D663: F3 0F 11 5C 24 40           -  movss [rsp+40],xmm3
"Darksiders2.exe"+19D669: F3 0F 11 4C 24 48           -  movss [rsp+48],xmm1
"Darksiders2.exe"+19D66F: F3 0F 11 54 24 44           -  movss [rsp+44],xmm2
"Darksiders2.exe"+19D675: 48 8B 44 24 40              -  mov rax,[rsp+40]
"Darksiders2.exe"+19D67A: 48 89 44 24 70              -  mov [rsp+70],rax
"Darksiders2.exe"+19D67F: 48 8B 44 24 48              -  mov rax,[rsp+48]
"Darksiders2.exe"+19D684: F3 0F 10 5C 24 70           -  movss xmm3,[rsp+70]
"Darksiders2.exe"+19D68A: F3 0F 10 44 24 74           -  movss xmm0,[rsp+74]
"Darksiders2.exe"+19D690: 48 89 44 24 78              -  mov [rsp+78],rax
"Darksiders2.exe"+19D695: F3 0F 10 4C 24 78           -  movss xmm1,[rsp+78]
}
</AssemblerScript>
                </CheatEntry>
              </CheatEntries>
            </CheatEntry>
            <CheatEntry>
              <ID>3187</ID>
              <Description>"________________                                Mario 64 Style Zoom Adjust End               _______________________"</Description>
              <LastState Value="" Activated="0" RealAddress="00000000"/>
              <Color>DDA58C</Color>
              <GroupHeader>1</GroupHeader>
            </CheatEntry>
          </CheatEntries>
        </CheatEntry>
        <CheatEntry>
          <ID>2806</ID>
          <Description>"Oni Lock Targeting Overlord"</Description>
          <Options moHideChildren="1" moBindActivation="1" moManualExpandCollapse="1"/>
          <LastState Value="" Activated="0" RealAddress="00000000"/>
          <Color>FF8000</Color>
          <GroupHeader>1</GroupHeader>
          <CheatEntries>
            <CheatEntry>
              <ID>2808</ID>
              <Description>"Enemy Swapping Camera Adjust "</Description>
              <Options moManualExpandCollapse="1"/>
              <LastState Activated="0"/>
              <Color>8F1881</Color>
              <VariableType>Auto Assembler Script</VariableType>
              <AssemblerScript>{ Game   : Darksiders2.exe
  Version: 
  Date   : 2015-12-23
  Author : Akuma

  This script does blah blah blah
}

[ENABLE]
//code from here to '[DISABLE]' will be used to enable the cheat

 
 
aobscanmodule(Switching_Enemies_ret,Darksiders2.exe,4E 10 48 8B 01 48 8D 55 50) // should be unique
alloc(newmem,$1000,"Darksiders2.exe"+23D346)


alloc(Enemy_Switch_Condition,8)
registersymbol(Enemy_Switch_Condition)
alloc(Allow_Camera_Adjust,4)
registersymbol(Allow_Camera_Adjust)

label(code)
label(No_Enemy_Swap)
label(Enemy_Swap_With_L1)
label(Lock_Out_Swapping)
label(Camera_Adjust_Off)
label(originalcode)
label(return)


Enemy_Switch_Condition:
db 1



///////////       RDX and RAX are useable registers        \\\\\\\\\\\\\\\\\\

////////////////////  R13 is Death Stat

newmem:
code:
  mov rax,[r13+a9b]             // Moving L1 Button Into RAX
// Checking Option for L1
  cmp [Enemy_Switch_Condition],1     // Swap Enemy While Holding L1
   je Enemy_Swap_With_L1
    jne No_Enemy_Swap

No_Enemy_Swap:
    cmp al,1                      // Comparing Lower Byte Of RAX For Button Push
      je Lock_Out_Swapping
        jne Camera_Adjust_Off


Enemy_Swap_With_L1:
  cmp al,0                      // Comparing Lower Byte Of RAX For Button Push
      je Lock_Out_Swapping
        jne Camera_Adjust_Off




Lock_Out_Swapping:
  xorps xmm7,xmm7   // clearing "up down" Switching
  xorps xmm11,xmm11 // clearing "left right" Switching
  mov [Allow_Camera_Adjust],1
   jmp originalcode



Camera_Adjust_Off:
  mov [Allow_Camera_Adjust],0
originalcode:
  mov rax,[rcx]
  lea rdx,[rbp+50]
   jmp return

Switching_Enemies_ret+02:
  jmp code
  nop
  nop
return:
registersymbol(Switching_Enemies_ret)

[DISABLE]
//code from here till the end of the code will be used to disable the cheat
Switching_Enemies_ret+02:
  db 48 8B 01 48 8D 55 50

unregistersymbol(Switching_Enemies_ret)
dealloc(newmem)

{
// ORIGINAL CODE - INJECTION POINT: "Darksiders2.exe"+23D346

"Darksiders2.exe"+23D31A: 4C 03 C2                       -  add r8,rdx
"Darksiders2.exe"+23D31D: 4C 8D 0D 88 FD FF FF           -  lea r9,[Darksiders2.exe+23D0AC]
"Darksiders2.exe"+23D324: 49 8B D2                       -  mov rdx,r10
"Darksiders2.exe"+23D327: 48 8B CB                       -  mov rcx,rbx
"Darksiders2.exe"+23D32A: E8 09 0C 00 00                 -  call Darksiders2.exe+23DF38
"Darksiders2.exe"+23D32F: 4D 8B E7                       -  mov r12,r15
"Darksiders2.exe"+23D332: 4D 8B B5 B8 0A 00 00           -  mov r14,[r13+00000AB8]
"Darksiders2.exe"+23D339: 4D 85 F6                       -  test r14,r14
"Darksiders2.exe"+23D33C: 0F 84 CE 02 00 00              -  je Darksiders2.exe+23D610
"Darksiders2.exe"+23D342: 49 8D 4E 10                    -  lea rcx,[r14+10]
// ---------- INJECTING HERE ----------
"Darksiders2.exe"+23D346: 48 8B 01                       -  mov rax,[rcx]
"Darksiders2.exe"+23D349: 48 8D 55 50                    -  lea rdx,[rbp+50]
// ---------- DONE INJECTING  ----------
"Darksiders2.exe"+23D34D: FF 50 10                       -  call qword ptr [rax+10]
"Darksiders2.exe"+23D350: F3 44 0F 10 85 80 00 00 00     -  movss xmm8,[rbp+00000080]
"Darksiders2.exe"+23D359: F3 44 0F 11 45 E0              -  movss [rbp-20],xmm8
"Darksiders2.exe"+23D35F: F3 44 0F 10 8D 84 00 00 00     -  movss xmm9,[rbp+00000084]
"Darksiders2.exe"+23D368: F3 44 0F 11 4D E4              -  movss [rbp-1C],xmm9
"Darksiders2.exe"+23D36E: F3 44 0F 10 95 88 00 00 00     -  movss xmm10,[rbp+00000088]
"Darksiders2.exe"+23D377: F3 44 0F 11 55 E8              -  movss [rbp-18],xmm10
"Darksiders2.exe"+23D37D: 48 8B 0D 04 BB B5 01           -  mov rcx,[Darksiders2.exe+1D98E88]
"Darksiders2.exe"+23D384: 48 85 C9                       -  test rcx,rcx
"Darksiders2.exe"+23D387: 75 0C                          -  jne Darksiders2.exe+23D395
}
</AssemblerScript>
              <CheatEntries>
                <CheatEntry>
                  <ID>2819</ID>
                  <Description>"Enemy_Switch_Condition"</Description>
                  <DropDownList DisplayValueAsItem="1">0: L1 Camera
1: L1 Switch 
</DropDownList>
                  <LastState Value="??" Activated="0" RealAddress="00000000"/>
                  <Color>80000008</Color>
                  <VariableType>4 Bytes</VariableType>
                  <Address>Enemy_Switch_Condition</Address>
                </CheatEntry>
                <CheatEntry>
                  <ID>2818</ID>
                  <Description>"Camera_Adjust_Flag"</Description>
                  <LastState Value="??" Activated="0" RealAddress="00000000"/>
                  <Color>80000008</Color>
                  <VariableType>4 Bytes</VariableType>
                  <Address>Allow_Camera_Adjust</Address>
                </CheatEntry>
              </CheatEntries>
            </CheatEntry>
            <CheatEntry>
              <ID>2920</ID>
              <Description>"Right Stick Input"</Description>
              <Options moManualExpandCollapse="1"/>
              <LastState Activated="0"/>
              <Color>FF8000</Color>
              <VariableType>Auto Assembler Script</VariableType>
              <AssemblerScript>{ Game   : Darksiders2.exe
  Version: 
  Date   : 2015-12-27
  Author : Akuma

  This script does blah blah blah
}

[ENABLE]

aobscanmodule(Left_Right_View_Joystick,Darksiders2.exe,F3 0F 11 43 60 48 8B 4B) // should be unique
alloc(newmem_input_left_right,$22,"Darksiders2.exe"+798CCA)

aobscanmodule(Up_Down_View_Joystick,Darksiders2.exe,F3 0F 11 43 64 48 8B 4B) // should be unique
alloc(newmem_input_down_up,$22,"Darksiders2.exe"+798CE0)


alloc(Left_Right,4)
registersymbol(Left_Right)
alloc(Up_Down,4)
registersymbol(Up_Down)


label(code_Left_Right)
label(return_Left_Right)
label(code_Up_Down)
label(return_Up_Down)

newmem_input_left_right:

code_Left_Right:
  movss [Left_Right],xmm0
  movss [rbx+60],xmm0
    jmp return_Left_Right

Left_Right_View_Joystick:
  jmp code_Left_Right
return_Left_Right:
registersymbol(Left_Right_View_Joystick)

newmem_input_down_up:

code_Up_Down:
  movss [Up_Down],xmm0
  movss [rbx+64],xmm0
  jmp return_Up_Down


Up_Down_View_Joystick:
  jmp code_Up_Down
return_Up_Down:
registersymbol(Up_Down_View_Joystick)



[DISABLE]

Left_Right_View_Joystick:
  db F3 0F 11 43 60

Up_Down_View_Joystick:
  db F3 0F 11 43 64

unregistersymbol(Left_Right_View_Joystick)
dealloc(newmem_input_left_right)
unregistersymbol(Up_Down_View_Joystick)
dealloc(newmem_input_down_up)

dealloc(Left_Right)
unregistersymbol(Left_Right)
dealloc(Up_Down)
unregistersymbol(Up_Down)

{
// ORIGINAL CODE - INJECTION POINT: "Darksiders2.exe"+798CCA

"Darksiders2.exe"+798CA7: 48 8B 01           -  mov rax,[rcx]
"Darksiders2.exe"+798CAA: FF 50 28           -  call qword ptr [rax+28]
"Darksiders2.exe"+798CAD: 45 33 C0           -  xor r8d,r8d
"Darksiders2.exe"+798CB0: 41 8D 50 02        -  lea edx,[r8+02]
"Darksiders2.exe"+798CB4: F3 0F 11 43 5C     -  movss [rbx+5C],xmm0
"Darksiders2.exe"+798CB9: 48 8B 4B 08        -  mov rcx,[rbx+08]
"Darksiders2.exe"+798CBD: 48 8B 01           -  mov rax,[rcx]
"Darksiders2.exe"+798CC0: FF 50 28           -  call qword ptr [rax+28]
"Darksiders2.exe"+798CC3: 45 33 C0           -  xor r8d,r8d
"Darksiders2.exe"+798CC6: 41 8D 50 03        -  lea edx,[r8+03]
// ---------- INJECTING HERE ----------
"Darksiders2.exe"+798CCA: F3 0F 11 43 60     -  movss [rbx+60],xmm0
// ---------- DONE INJECTING  ----------
"Darksiders2.exe"+798CCF: 48 8B 4B 08        -  mov rcx,[rbx+08]
"Darksiders2.exe"+798CD3: 48 8B 01           -  mov rax,[rcx]
"Darksiders2.exe"+798CD6: FF 50 28           -  call qword ptr [rax+28]
"Darksiders2.exe"+798CD9: 45 33 C0           -  xor r8d,r8d
"Darksiders2.exe"+798CDC: 41 8D 50 04        -  lea edx,[r8+04]
"Darksiders2.exe"+798CE0: F3 0F 11 43 64     -  movss [rbx+64],xmm0    // up down
"Darksiders2.exe"+798CE5: 48 8B 4B 08        -  mov rcx,[rbx+08]
"Darksiders2.exe"+798CE9: 48 8B 01           -  mov rax,[rcx]
"Darksiders2.exe"+798CEC: FF 50 28           -  call qword ptr [rax+28]
"Darksiders2.exe"+798CEF: 48 8B 4B 08        -  mov rcx,[rbx+08]
}
</AssemblerScript>
              <CheatEntries>
                <CheatEntry>
                  <ID>2921</ID>
                  <Description>"Value of Up Down Input"</Description>
                  <LastState Value="??" Activated="0" RealAddress="00000000"/>
                  <Color>1147A2</Color>
                  <VariableType>Float</VariableType>
                  <Address>Up_Down</Address>
                </CheatEntry>
                <CheatEntry>
                  <ID>2922</ID>
                  <Description>"Value of Left RIght Input"</Description>
                  <LastState Value="??" Activated="0" RealAddress="00000000"/>
                  <Color>1147A2</Color>
                  <VariableType>Float</VariableType>
                  <Address>Left_Right</Address>
                </CheatEntry>
              </CheatEntries>
            </CheatEntry>
            <CheatEntry>
              <ID>2886</ID>
              <Description>"Oni Lock Cam Elevation"</Description>
              <Options moManualExpandCollapse="1"/>
              <LastState Activated="0"/>
              <Color>7416C9</Color>
              <VariableType>Auto Assembler Script</VariableType>
              <AssemblerScript>{ Game   : Darksiders2.exe
  Version: 
  Date   : 2015-12-19
  Author : Akuma

  This script does blah blah blah
}

[ENABLE]

aobscanmodule(Targeted_Lock_On_Hieght_ret,Darksiders2.exe,F3 41 0F 58 C6 * * * * CD 41) // should be unique
alloc(newmem,$1000,"Darksiders2.exe"+23B7FB)


label(Locking_View)
label(check)
label(code)
label(Camera_Move_Up)
label(Camera_Move_Down)
label(Hieght_Restricted_Up)
label(Hieght_Restricted_Down)
label(originalcode)
label(return)

alloc(Height_Adjust_Lock_On,16)
registersymbol(Height_Adjust_Lock_On)

alloc(Camera_Range_Z,8)
registersymbol(Camera_Range_Z)

alloc(Camera_Range_Z_Mult,8)
registersymbol(Camera_Range_Z_Mult)

alloc(Camera_Range_Z_Store,32)
registersymbol(Camera_Range_Z_Store)

alloc(Stick_Range,8)
registersymbol(Stick_Range)

alloc(Camera_Flag,4)
registersymbol(Camera_Flag)


alloc(Camera_Rate_up_down,8)
registersymbol(Camera_Rate_up_down)




Camera_Range_Z_Mult:
dd (float)3

Camera_Range_Z:                  // Hight Cap of camera
dd (float)400

Stick_Range:                  // tick range up
dd (float)0.300

Stick_Range+4:              // stick range down
dd (float)-0.300




Height_Adjust_Lock_On:
dd (float)90


Camera_Rate_up_down:
dd (float)3


Camera_Rate_up_down+4:
dd (float)3


newmem:
// comiss for zero -1 , 1,  and 0


// comiss for zero to remain static
         //then add and sub with the stick value

                     // Script will require a lock out


check:
  cmp [Allow_Camera_Adjust],1
    je code
     jne originalcode

code:
   mov [Camera_Flag],0                              // comiss checker
  movss [Height_Adjust_Lock_On+4],xmm0     // Default
//storing vslues
  movss [Camera_Range_Z_Store],xmm10               // push pops
  movss [Camera_Range_Z_Store+4],xmm11
  movss [Camera_Range_Z_Store+8],xmm15

//Moving Values IN
  movss xmm15,[Up_Down]                          // xmm15 is stick value
   comiss xmm15,[Stick_Range]                // Checking Stick Up
    ja Camera_Move_Up
   comiss xmm15,[Stick_Range+4]               // Checking Stick Up
    jb Camera_Move_Down
     jmp Locking_View

Camera_Move_Up:
    mov [Camera_Flag],1
    movss [Height_Adjust_Lock_On+c],xmm14
    movss xmm11,[Height_Adjust_Lock_On]
     comiss xmm11,[Camera_Range_Z]
      ja Hieght_Restricted_Up
    movss xmm10,[Camera_Rate_up_down]
    addss xmm11,xmm10
    movss [Height_Adjust_Lock_On],xmm11
       //movss [ZoomingMF],xmm11                        /// zmooth
    jmp Locking_View


Camera_Move_Down:
   mov [Camera_Flag],2
    movss [Height_Adjust_Lock_On+c],xmm14
    movss xmm11,[Height_Adjust_Lock_On]
      comiss xmm11,[Camera_Range_Z+4]
        jb Hieght_Restricted_Down
    movss xmm10,[Camera_Rate_up_down+4]
    subss xmm11,xmm10
    movss [Height_Adjust_Lock_On],xmm11
           //movss [ZoomingMF],xmm11                       /// zmooth
    jmp Locking_View





Hieght_Restricted_Up:
  jmp Locking_View

Hieght_Restricted_Down:
  jmp Locking_View




  mulss xmm11,xmm15                              // xmm11 is mathed hieght
  movss [Camera_Range_Z+4],xmm11                // visible
  mulss xmm11,[Camera_Range_Z_Mult]
  movss [Camera_Range_Z_Mult+4],xmm11           // Showing value
  movss [Height_Adjust_Lock_On],xmm11




Locking_View:
//Poping Values
  movss xmm15,[Camera_Range_Z_Store+8]
  movss xmm11,[Camera_Range_Z_Store+4]
  movss xmm10,[Camera_Range_Z_Store]

// Moving Changed Hieght
 // movss xmm0,[Height_Adjust_Lock_On]                 // Adjusted
  movss [Height_Adjust_Lock_On+8],xmm0


originalcode:
  addss xmm0,[Height_Adjust_Lock_On]
  //  addss xmm14,[Height_Adjust_Lock_On]
  addss xmm0,xmm14
   jmp return

Targeted_Lock_On_Hieght_ret:
  jmp check
return:
registersymbol(Targeted_Lock_On_Hieght_ret)

[DISABLE]

Targeted_Lock_On_Hieght_ret:
  db F3 41 0F 58 C6

unregistersymbol(Targeted_Lock_On_Hieght_ret)
dealloc(newmem)
dealloc(Height_Adjust_Lock_On)
unregistersymbol(Height_Adjust_Lock_On)

{
// ORIGINAL CODE - INJECTION POINT: "Darksiders2.exe"+23B7FB

"Darksiders2.exe"+23B7C9: 48 8D 8D E0 02 00 00     -  lea rcx,[rbp+000002E0]
"Darksiders2.exe"+23B7D0: 49 8B D6                 -  mov rdx,r14
"Darksiders2.exe"+23B7D3: 41 0F 28 D1              -  movaps xmm2,xmm9
"Darksiders2.exe"+23B7D7: 41 0F 28 C1              -  movaps xmm0,xmm9
"Darksiders2.exe"+23B7DB: 41 0F 28 C9              -  movaps xmm1,xmm9
"Darksiders2.exe"+23B7DF: F3 0F 59 85 A8 04 00 00  -  mulss xmm0,[rbp+000004A8]
"Darksiders2.exe"+23B7E7: F3 0F 59 4D A4           -  mulss xmm1,[rbp-5C]
"Darksiders2.exe"+23B7EC: F3 41 0F 59 D0           -  mulss xmm2,xmm8
"Darksiders2.exe"+23B7F1: F3 0F 58 D6              -  addss xmm2,xmm6
"Darksiders2.exe"+23B7F5: F3 41 0F 11 14 24        -  movss [r12],xmm2
// ---------- INJECTING HERE ----------
"Darksiders2.exe"+23B7FB: F3 41 0F 58 C6           -  addss xmm0,xmm14
// ---------- DONE INJECTING  ----------
"Darksiders2.exe"+23B800: F3 41 0F 58 CD           -  addss xmm1,xmm13
"Darksiders2.exe"+23B805: 41 0F 28 D1              -  movaps xmm2,xmm9
"Darksiders2.exe"+23B809: 41 0F C6 D1 55           -  shufps xmm2,xmm9,55
"Darksiders2.exe"+23B80E: F3 41 0F 11 44 24 08     -  movss [r12+08],xmm0
"Darksiders2.exe"+23B815: F3 41 0F 11 4C 24 04     -  movss [r12+04],xmm1
"Darksiders2.exe"+23B81C: 0F 28 C2                 -  movaps xmm0,xmm2
"Darksiders2.exe"+23B81F: 0F 28 CA                 -  movaps xmm1,xmm2
"Darksiders2.exe"+23B822: F3 0F 59 95 A8 04 00 00  -  mulss xmm2,[rbp+000004A8]
"Darksiders2.exe"+23B82A: F3 0F 59 45 A4           -  mulss xmm0,[rbp-5C]
"Darksiders2.exe"+23B82F: F3 41 0F 59 C8           -  mulss xmm1,xmm8
}
</AssemblerScript>
              <CheatEntries>
                <CheatEntry>
                  <ID>3016</ID>
                  <Description>"Max Height of Elevation"</Description>
                  <LastState Value="??" Activated="0" RealAddress="00000000"/>
                  <Color>D7286A</Color>
                  <VariableType>Float</VariableType>
                  <Address>Camera_Range_Z</Address>
                  <Hotkeys>
                    <Hotkey>
                      <Action>Decrease Value</Action>
                      <Keys>
                        <Key>188</Key>
                      </Keys>
                      <Value>10</Value>
                      <ID>0</ID>
                    </Hotkey>
                    <Hotkey>
                      <Action>Increase Value</Action>
                      <Keys>
                        <Key>190</Key>
                      </Keys>
                      <Value>10</Value>
                      <ID>1</ID>
                    </Hotkey>
                  </Hotkeys>
                </CheatEntry>
                <CheatEntry>
                  <ID>2804</ID>
                  <Description>"Added Height Variable's"</Description>
                  <Options moHideChildren="1" moManualExpandCollapse="1"/>
                  <LastState Value="" Activated="0" RealAddress="00000000"/>
                  <Color>80000008</Color>
                  <GroupHeader>1</GroupHeader>
                  <CheatEntries>
                    <CheatEntry>
                      <ID>2815</ID>
                      <Description>"Speed Multiplier for Stick Input"</Description>
                      <LastState Value="??" Activated="0" RealAddress="00000000"/>
                      <Color>80000008</Color>
                      <VariableType>Float</VariableType>
                      <Address>Camera_Range_Z_Mult</Address>
                      <CheatEntries>
                        <CheatEntry>
                          <ID>2816</ID>
                          <Description>"Calculated Speed + Stick Value"</Description>
                          <LastState Value="??" Activated="0" RealAddress="00000000"/>
                          <Color>80000008</Color>
                          <VariableType>Float</VariableType>
                          <Address>Camera_Range_Z_Mult+4</Address>
                        </CheatEntry>
                      </CheatEntries>
                    </CheatEntry>
                    <CheatEntry>
                      <ID>2904</ID>
                      <Description>"Camera_Rate_Up"</Description>
                      <LastState Value="??" Activated="0" RealAddress="00000000"/>
                      <Color>80000008</Color>
                      <VariableType>Float</VariableType>
                      <Address>Camera_Rate_up_down+4</Address>
                    </CheatEntry>
                    <CheatEntry>
                      <ID>2903</ID>
                      <Description>"Camera_Rate_Down"</Description>
                      <LastState Value="??" Activated="0" RealAddress="00000000"/>
                      <Color>80000008</Color>
                      <VariableType>Float</VariableType>
                      <Address>Camera_Rate_up_down</Address>
                    </CheatEntry>
                    <CheatEntry>
                      <ID>2803</ID>
                      <Description>"Camera Lock On Height"</Description>
                      <Options moManualExpandCollapse="1"/>
                      <LastState Value="" Activated="0" RealAddress="00000000"/>
                      <Color>80000008</Color>
                      <GroupHeader>1</GroupHeader>
                      <CheatEntries>
                        <CheatEntry>
                          <ID>2811</ID>
                          <Description>"Added Height To Camera"</Description>
                          <LastState Value="??" Activated="0" RealAddress="00000000"/>
                          <Color>FF8000</Color>
                          <VariableType>Float</VariableType>
                          <Address>Height_Adjust_Lock_On</Address>
                        </CheatEntry>
                        <CheatEntry>
                          <ID>2810</ID>
                          <Description>"Default Height of Camera"</Description>
                          <LastState Value="??" Activated="0" RealAddress="00000000"/>
                          <Color>808000</Color>
                          <VariableType>Float</VariableType>
                          <Address>Height_Adjust_Lock_On+4</Address>
                        </CheatEntry>
                        <CheatEntry>
                          <ID>2812</ID>
                          <Description>"Actual Height of Camera"</Description>
                          <LastState Value="??" Activated="0" RealAddress="00000000"/>
                          <Color>A400A4</Color>
                          <VariableType>Float</VariableType>
                          <Address>Height_Adjust_Lock_On+8</Address>
                          <Hotkeys>
                            <Hotkey>
                              <Action>Decrease Value</Action>
                              <Keys>
                                <Key>188</Key>
                              </Keys>
                              <Value>10</Value>
                              <ID>0</ID>
                            </Hotkey>
                            <Hotkey>
                              <Action>Increase Value</Action>
                              <Keys>
                                <Key>190</Key>
                              </Keys>
                              <Value>10</Value>
                              <ID>1</ID>
                            </Hotkey>
                          </Hotkeys>
                        </CheatEntry>
                        <CheatEntry>
                          <ID>2902</ID>
                          <Description>"Absolute Bottom Map Copy"</Description>
                          <LastState Value="??" Activated="0" RealAddress="00000000"/>
                          <Color>A400A4</Color>
                          <VariableType>Float</VariableType>
                          <Address>Height_Adjust_Lock_On+C</Address>
                          <Hotkeys>
                            <Hotkey>
                              <Action>Decrease Value</Action>
                              <Keys>
                                <Key>188</Key>
                              </Keys>
                              <Value>10</Value>
                              <ID>0</ID>
                            </Hotkey>
                            <Hotkey>
                              <Action>Increase Value</Action>
                              <Keys>
                                <Key>190</Key>
                              </Keys>
                              <Value>10</Value>
                              <ID>1</ID>
                            </Hotkey>
                          </Hotkeys>
                        </CheatEntry>
                      </CheatEntries>
                    </CheatEntry>
                  </CheatEntries>
                </CheatEntry>
                <CheatEntry>
                  <ID>2805</ID>
                  <Description>"Input/Flags"</Description>
                  <Options moHideChildren="1" moManualExpandCollapse="1"/>
                  <LastState Value="" Activated="0" RealAddress="00000000"/>
                  <Color>80000008</Color>
                  <GroupHeader>1</GroupHeader>
                  <CheatEntries>
                    <CheatEntry>
                      <ID>2899</ID>
                      <Description>"Camera_Flag_Group"</Description>
                      <DropDownList DisplayValueAsItem="1">0: No Input
1: Up Camera
2::Down Camera
 
</DropDownList>
                      <LastState Value="??" Activated="0" RealAddress="00000000"/>
                      <Color>80000008</Color>
                      <VariableType>4 Bytes</VariableType>
                      <Address>Camera_Flag</Address>
                    </CheatEntry>
                    <CheatEntry>
                      <ID>2900</ID>
                      <Description>"Stick_Threshold__UP__Input"</Description>
                      <LastState Value="??" Activated="0" RealAddress="00000000"/>
                      <Color>80000008</Color>
                      <VariableType>Float</VariableType>
                      <Address>Stick_Range</Address>
                    </CheatEntry>
                    <CheatEntry>
                      <ID>2901</ID>
                      <Description>"Stick_Threshold_Down_Input"</Description>
                      <LastState Value="??" Activated="0" RealAddress="00000000"/>
                      <Color>80000008</Color>
                      <VariableType>Float</VariableType>
                      <Address>Stick_Range+4</Address>
                    </CheatEntry>
                  </CheatEntries>
                </CheatEntry>
              </CheatEntries>
            </CheatEntry>
            <CheatEntry>
              <ID>3058</ID>
              <Description>"Oni Lock Cam Gyroscope"</Description>
              <Options moManualExpandCollapse="1"/>
              <LastState Activated="0"/>
              <Color>EE155B</Color>
              <VariableType>Auto Assembler Script</VariableType>
              <AssemblerScript>{ Game   : Darksiders2.exe
  Version: 
  Date   : 2015-12-27
  Author : Akuma

  This script does blah blah blah
}

[ENABLE]

aobscanmodule(Lock_On_Outside_Camera_Rotation_ret,Darksiders2.exe,48 8B D3 44 0F 28 F0) // should be unique
alloc(newmem,$1000,"Darksiders2.exe"+23BA03)

alloc(Outside_Rotation_Lock,12)
Registersymbol(Outside_Rotation_Lock)

alloc(Xmm_Registers_Rotation,12)
registersymbol(Xmm_Registers_Rotation)


alloc(Stick_Threshold_XY,16)
registersymbol(Stick_Threshold_XY)


alloc(Camera_Rate_X_Y,12)
registersymbol(Camera_Rate_X_Y)

alloc(Master_360,8)
registersymbol(Master_360)


alloc(Show_Expo,8)
registersymbol(Show_Expo)

alloc(Invert_X_Rotate,4)
registersymbol(Invert_X_Rotate)

alloc(Distance_Between,32)
registersymbol(Distance_Between)


alloc(Offset_Center,8)
registersymbol(Offset_Center)

alloc(Tail_Cam_Seal,1)
registersymbol(Tail_Cam_Seal)




label(code)
label(Loading)
label(Camera_Sub_Rotation)
label(Camera_Sub_Rotation_Lv2)
label(Camera_Sub_Final)
label(Camera_Sub_Flip)
label(Camera_Sub_Finish)
label(Camera_Add_Rotation)
label(Camera_Add_Rotation_Lv2)
label(Camera_Add_Final)
label(Camera_Add_Flip)
label(Camera_Add_Finish)
label(Center_View)
label(Rotation)
label(Rotation_Fix_Add_360)
label(Rotation_Fix_Sub_360)
label(Poping_Xmm)
label(Distance_Fix_Sub_360)
label(Distance_Fix_Add_360_Prep)
label(Distance_Fix_Add_360)
label(Tail_Cam_Sealing)
label(Tail_Cam)
label(originalcode)
label(return)


Camera_Rate_X_Y:               // Camera Rate lv.1
dd (float)0.3

Camera_Rate_X_Y+4:               // Camera Rate lv.1
dd (float)3


Master_360:
  dd (float)360

Stick_Threshold_XY:
 dd (float)0.23

Stick_Threshold_XY+4:
 dd (float)-0.23

Stick_Threshold_XY+8:
 dd (float)0.6100000143

Stick_Threshold_XY+C:
 dd (float)-0.6100000143


Camera_Rate_X_Y+8:
  dd (float)-1












newmem:
code:



//Pushing_Xmm:
  movss [Xmm_Registers_Rotation],xmm10               // push pops
  movss [Xmm_Registers_Rotation+4],xmm11
  movss [Xmm_Registers_Rotation+8],xmm15
   cmp byte ptr [r15+00000A9F],01
      je Center_View

   cmp [Allow_Camera_Adjust],1
    je Loading
     jne Rotation




Loading:
   movss xmm15,[Left_Right]
   movss xmm11,[Stick_Threshold_XY]
   movss xmm10,[Stick_Threshold_XY+4]
    comiss xmm10,xmm15                  // Checking Stick threshold
     ja Camera_Sub_Rotation
    comiss xmm11,xmm15                  // Checking Stick threshold
     jb Camera_Add_Rotation
    cmp [Tail_Cam_Seal],1                         // Tail Cam Seal
        je Tail_Cam
    cmp byte ptr [r15+00000A9d],01
           je Tail_Cam_Sealing

      jmp Rotation

Camera_Sub_Rotation:
     mov [Tail_Cam_Seal],0                       // Breaking Seal if Camera Adjusted
    movss xmm10,[Stick_Threshold_XY+C]
      comiss xmm10,xmm15                  // Checking Stick threshold lv.2
       ja Camera_Sub_Rotation_Lv2
    movss xmm10,[Camera_Rate_X_Y]
       jmp Camera_Sub_Final


Camera_Sub_Rotation_Lv2:
    movss xmm10,xmm15
    mulss xmm10,xmm10
    mulss xmm10,[Camera_Rate_X_Y+4]
    addss xmm10,xmm15
    movss [Show_Expo+4],xmm10
     jmp Camera_Sub_Final


Camera_Sub_Final:
  movss xmm11,[Outside_Rotation_Lock]
    cmp [Invert_X_Rotate],1
     je Camera_Sub_Flip
    Addss xmm11,xmm10
      jmp Camera_Sub_Finish
Camera_Sub_Flip:
    Subss xmm11,xmm10
Camera_Sub_Finish:
    movss [Outside_Rotation_Lock],xmm11
    jmp Rotation






Camera_Add_Rotation:
    mov [Tail_Cam_Seal],0                       // Breaking Seal if Camera Adjusted
    movss xmm11,[Stick_Threshold_XY+8]
     comiss xmm11,xmm15                  // Checking Stick threshold lv2
      jb Camera_Add_Rotation_Lv2
    movss xmm11,[Outside_Rotation_Lock]
    movss xmm10,[Camera_Rate_X_Y]
      jmp Camera_Add_Final


Camera_Add_Rotation_Lv2:
    movss xmm10,xmm15
    mulss xmm10,xmm10
    mulss xmm10,[Camera_Rate_X_Y+4]
    subss xmm10,xmm15
    movss [Show_Expo],xmm10
//    mulss xmm10,[Camera_Rate_X_Y+8]        // negative 1 to flip
     jmp Camera_Add_Final



Camera_Add_Final:
    movss xmm11,[Outside_Rotation_Lock]
    cmp [Invert_X_Rotate],1
     je Camera_Add_Flip
    Subss xmm11,xmm10
      jmp Camera_Add_Finish
Camera_Add_Flip:
    Addss xmm11,xmm10
Camera_Add_Finish:
    movss [Outside_Rotation_Lock],xmm11
    jmp Rotation






Center_View:
  movss xmm15,[r15+160]                  //death facing degree
//  movss xmm10,[Outside_Rotation_Lock]
//  movss xmm11,[Outside_Rotation_Lock]
//  subss xmm10,xmm15

 // addss xmm10,xmm11
  addss  xmm15,[Offset_Center]
  movss [Outside_Rotation_Lock],xmm15
  jmp Rotation




Rotation:
   movss [Outside_Rotation_Lock+4],xmm0          //Game Calculated
   movss xmm15,[Outside_Rotation_Lock]
   movss xmm10,[Master_360]         //360
   movss xmm11,[Master_360+4]           // Zero for negative
    comiss xmm15,xmm10
     ja Rotation_Fix_Sub_360
    comiss xmm15,xmm11
     jb Rotation_Fix_Add_360


   //end

   jmp Poping_Xmm


Rotation_Fix_Sub_360:
  subss xmm15,xmm10
  movss [Outside_Rotation_Lock],xmm15
  jmp Poping_Xmm

Rotation_Fix_Add_360:
  addss xmm15,xmm10
  movss [Outside_Rotation_Lock],xmm15
  jmp Poping_Xmm






Poping_Xmm:
  movss xmm15,[r15+160]
  movss xmm0,[Outside_Rotation_Lock]
  subss xmm15,xmm0
  movss [Distance_Between],xmm15
  movss xmm11,xmm15
  subss xmm15,xmm0
  movss [Distance_Between+4],xmm15
  movss xmm10,[r15+160]
  movss xmm15,xmm0
  subss xmm15,xmm10
  movss [Distance_Between+8],xmm15
  movss [Distance_Between+12],xmm15
  movss xmm10,[Master_360+4]
   comiss xmm15,xmm10
     jb Distance_Fix_Sub_360
       jmp Distance_Fix_Add_360

Distance_Fix_Sub_360:
  addss xmm15,[Master_360]
  movss [Distance_Between+C],xmm15
  movss [Distance_Between+12],xmm15
   jmp Distance_Fix_Add_360_Prep

Distance_Fix_Add_360_Prep:
   movss [Distance_Between+16],xmm11
   comiss xmm11,xmm10
     jb Distance_Fix_Add_360
       jmp Tail_Cam

Distance_Fix_Add_360:
   addss xmm11,[Master_360]
   movss [Distance_Between+16],xmm11
     jmp Tail_Cam



Tail_Cam_Sealing:
  mov [Tail_Cam_Seal],1
Tail_Cam:
  movss xmm15,[Xmm_Registers_Rotation+8]
  movss xmm11,[Xmm_Registers_Rotation+4]
  movss xmm10,[Xmm_Registers_Rotation]
  jmp originalcode




originalcode:
  mov rdx,rbx
  movss [Outside_Rotation_Lock],xmm0
  movaps xmm14,xmm0

  jmp return

Lock_On_Outside_Camera_Rotation_ret:
  jmp code
  nop
  nop
return:
registersymbol(Lock_On_Outside_Camera_Rotation_ret)

[DISABLE]

Lock_On_Outside_Camera_Rotation_ret:
  db 48 8B D3 44 0F 28 F0

unregistersymbol(Lock_On_Outside_Camera_Rotation_ret)
dealloc(newmem)

{
// ORIGINAL CODE - INJECTION POINT: "Darksiders2.exe"+23BA03

"Darksiders2.exe"+23B9D0: F3 41 0F 5C C0           -  subss xmm0,xmm8
"Darksiders2.exe"+23B9D5: F3 0F 11 45 60           -  movss [rbp+60],xmm0
"Darksiders2.exe"+23B9DA: F3 0F 10 45 F8           -  movss xmm0,[rbp-08]
"Darksiders2.exe"+23B9DF: F3 0F 11 4D 64           -  movss [rbp+64],xmm1
"Darksiders2.exe"+23B9E4: F3 0F 5C 45 D0           -  subss xmm0,[rbp-30]
"Darksiders2.exe"+23B9E9: F3 0F 11 45 68           -  movss [rbp+68],xmm0
"Darksiders2.exe"+23B9EE: 0F 28 45 60              -  movaps xmm0,[rbp+60]
"Darksiders2.exe"+23B9F2: 66 0F 7F 85 90 02 00 00  -  movdqa [rbp+00000290],xmm0
"Darksiders2.exe"+23B9FA: E8 61 36 7A 00           -  call Darksiders2.exe+9DF060
"Darksiders2.exe"+23B9FF: 48 8D 4D C0              -  lea rcx,[rbp-40]
// ---------- INJECTING HERE ----------
"Darksiders2.exe"+23BA03: 48 8B D3                 -  mov rdx,rbx
"Darksiders2.exe"+23BA06: 44 0F 28 F0              -  movaps xmm14,xmm0
// ---------- DONE INJECTING  ----------
"Darksiders2.exe"+23BA0A: E8 51 36 7A 00           -  call Darksiders2.exe+9DF060
"Darksiders2.exe"+23BA0F: 0F 28 C8                 -  movaps xmm1,xmm0
"Darksiders2.exe"+23BA12: 41 0F 28 C6              -  movaps xmm0,xmm14
"Darksiders2.exe"+23BA16: E8 55 3A 7A 00           -  call Darksiders2.exe+9DF470
"Darksiders2.exe"+23BA1B: 0F 57 ED                 -  xorps xmm5,xmm5
"Darksiders2.exe"+23BA1E: F3 0F 5A E8              -  cvtss2sd xmm5,xmm0
"Darksiders2.exe"+23BA22: 0F 54 2D 67 BF 3E 01     -  andps xmm5,[Darksiders2.exe+1627990]
"Darksiders2.exe"+23BA29: 66 0F 5A CD              -  cvtpd2ps xmm1,xmm5
"Darksiders2.exe"+23BA2D: 0F 2F CE                 -  comiss xmm1,xmm6
"Darksiders2.exe"+23BA30: 76 59                    -  jna Darksiders2.exe+23BA8B
}
</AssemblerScript>
              <CheatEntries>
                <CheatEntry>
                  <ID>3059</ID>
                  <Description>"                               Tap L3 - Trailing Cam     Tap R3 - Fast View Center"</Description>
                  <LastState Value="" Activated="0" RealAddress="00000000"/>
                  <Color>0EB80A</Color>
                  <GroupHeader>1</GroupHeader>
                </CheatEntry>
                <CheatEntry>
                  <ID>3060</ID>
                  <Description>"Invert Camera X Input      ------&gt;"</Description>
                  <DropDownList DescriptionOnly="1" DisplayValueAsItem="1">0:Default
1:Inverted
</DropDownList>
                  <LastState Value="??" Activated="0" RealAddress="00000000"/>
                  <Color>800080</Color>
                  <VariableType>Byte</VariableType>
                  <Address>Invert_X_Rotate</Address>
                </CheatEntry>
                <CheatEntry>
                  <ID>3090</ID>
                  <Description>"R3 Fast Center Degree's"</Description>
                  <LastState Value="??" Activated="0" RealAddress="00000000"/>
                  <Color>5B8F30</Color>
                  <VariableType>Float</VariableType>
                  <Address>Offset_Center</Address>
                </CheatEntry>
                <CheatEntry>
                  <ID>3154</ID>
                  <Description>"Distance &amp; Rotation"</Description>
                  <Options moHideChildren="1" moManualExpandCollapse="1"/>
                  <LastState Value="" Activated="0" RealAddress="00000000"/>
                  <Color>80000008</Color>
                  <GroupHeader>1</GroupHeader>
                  <CheatEntries>
                    <CheatEntry>
                      <ID>3094</ID>
                      <Description>"Distance_Between Add"</Description>
                      <LastState Value="??" Activated="0" RealAddress="00000000"/>
                      <Color>80000008</Color>
                      <VariableType>Float</VariableType>
                      <Address>Distance_Between+16</Address>
                      <CheatEntries>
                        <CheatEntry>
                          <ID>3084</ID>
                          <Description>"Distance_Between Add"</Description>
                          <LastState Value="??" Activated="0" RealAddress="00000000"/>
                          <Color>C0C0C0</Color>
                          <VariableType>Float</VariableType>
                          <Address>Distance_Between</Address>
                        </CheatEntry>
                      </CheatEntries>
                    </CheatEntry>
                    <CheatEntry>
                      <ID>3093</ID>
                      <Description>"Distance_Between Sub"</Description>
                      <LastState Value="??" Activated="0" RealAddress="00000000"/>
                      <Color>800080</Color>
                      <VariableType>Float</VariableType>
                      <Address>Distance_Between+12</Address>
                      <CheatEntries>
                        <CheatEntry>
                          <ID>3091</ID>
                          <Description>"Distance_Between"</Description>
                          <LastState Value="??" Activated="0" RealAddress="00000000"/>
                          <Color>C0C0C0</Color>
                          <VariableType>Float</VariableType>
                          <Address>Distance_Between+8</Address>
                        </CheatEntry>
                        <CheatEntry>
                          <ID>3092</ID>
                          <Description>"Distance_Between Sub"</Description>
                          <LastState Value="??" Activated="0" RealAddress="00000000"/>
                          <Color>C0C0C0</Color>
                          <VariableType>Float</VariableType>
                          <Address>Distance_Between+C</Address>
                        </CheatEntry>
                      </CheatEntries>
                    </CheatEntry>
                    <CheatEntry>
                      <ID>2957</ID>
                      <Description>"Death Facing Orientation"</Description>
                      <LastState Value="??" Activated="0" RealAddress="00000000"/>
                      <Color>643788</Color>
                      <VariableType>Float</VariableType>
                      <Address>Death_Stat</Address>
                      <Offsets>
                        <Offset>160</Offset>
                        <Offset>170</Offset>
                      </Offsets>
                    </CheatEntry>
                    <CheatEntry>
                      <ID>3061</ID>
                      <Description>"Input Manipulated Rotation"</Description>
                      <LastState Value="??" Activated="0" RealAddress="00000000"/>
                      <Color>8E5431</Color>
                      <VariableType>Float</VariableType>
                      <Address>Outside_Rotation_Lock</Address>
                    </CheatEntry>
                    <CheatEntry>
                      <ID>3082</ID>
                      <Description>"Game Value of Camera Rotation "</Description>
                      <LastState Value="??" Activated="0" RealAddress="00000000"/>
                      <Color>5B8F30</Color>
                      <VariableType>Float</VariableType>
                      <Address>Outside_Rotation_Lock+4</Address>
                      <Hotkeys>
                        <Hotkey>
                          <Action>Increase Value</Action>
                          <Keys>
                            <Key>190</Key>
                          </Keys>
                          <Value>2</Value>
                          <ID>0</ID>
                        </Hotkey>
                        <Hotkey>
                          <Action>Decrease Value</Action>
                          <Keys>
                            <Key>188</Key>
                          </Keys>
                          <Value>2</Value>
                          <ID>1</ID>
                        </Hotkey>
                      </Hotkeys>
                    </CheatEntry>
                  </CheatEntries>
                </CheatEntry>
                <CheatEntry>
                  <ID>3062</ID>
                  <Description>"Input Variables"</Description>
                  <Options moHideChildren="1" moManualExpandCollapse="1"/>
                  <LastState Value="" Activated="0" RealAddress="00000000"/>
                  <Color>80000008</Color>
                  <GroupHeader>1</GroupHeader>
                  <CheatEntries>
                    <CheatEntry>
                      <ID>3063</ID>
                      <Description>"Rates"</Description>
                      <LastState Value="" Activated="0" RealAddress="00000000"/>
                      <Color>80000008</Color>
                      <GroupHeader>1</GroupHeader>
                      <CheatEntries>
                        <CheatEntry>
                          <ID>3064</ID>
                          <Description>"Movement Rate Lv.1"</Description>
                          <LastState Value="??" Activated="0" RealAddress="00000000"/>
                          <Color>FF5959</Color>
                          <VariableType>Float</VariableType>
                          <Address>Camera_Rate_X_Y</Address>
                        </CheatEntry>
                        <CheatEntry>
                          <ID>3065</ID>
                          <Description>"Movement Rate Exponential"</Description>
                          <LastState Value="??" Activated="0" RealAddress="00000000"/>
                          <Color>BC64C4</Color>
                          <VariableType>Float</VariableType>
                          <Address>Camera_Rate_X_Y+4</Address>
                        </CheatEntry>
                      </CheatEntries>
                    </CheatEntry>
                    <CheatEntry>
                      <ID>3066</ID>
                      <Description>"Exponential Algorithm Rate Lv.2"</Description>
                      <LastState Value="" Activated="0" RealAddress="00000000"/>
                      <Color>80000008</Color>
                      <GroupHeader>1</GroupHeader>
                      <CheatEntries>
                        <CheatEntry>
                          <ID>3067</ID>
                          <Description>"Show Exponential Algorithm Right"</Description>
                          <LastState Value="??" Activated="0" RealAddress="00000000"/>
                          <Color>808000</Color>
                          <VariableType>Float</VariableType>
                          <Address>Show_Expo</Address>
                        </CheatEntry>
                        <CheatEntry>
                          <ID>3068</ID>
                          <Description>"Show Exponential Algorithm Left"</Description>
                          <LastState Value="??" Activated="0" RealAddress="00000000"/>
                          <Color>400080</Color>
                          <VariableType>Float</VariableType>
                          <Address>Show_Expo+4</Address>
                        </CheatEntry>
                      </CheatEntries>
                    </CheatEntry>
                    <CheatEntry>
                      <ID>3069</ID>
                      <Description>"Stick Thresholds"</Description>
                      <Options moManualExpandCollapse="1"/>
                      <LastState Value="" Activated="0" RealAddress="00000000"/>
                      <Color>80000008</Color>
                      <GroupHeader>1</GroupHeader>
                      <CheatEntries>
                        <CheatEntry>
                          <ID>3070</ID>
                          <Description>"Level 1"</Description>
                          <LastState Value="" Activated="0" RealAddress="00000000"/>
                          <Color>80000008</Color>
                          <GroupHeader>1</GroupHeader>
                          <CheatEntries>
                            <CheatEntry>
                              <ID>3071</ID>
                              <Description>"Stick_Threshold_Right Lv.1"</Description>
                              <LastState Value="??" Activated="0" RealAddress="00000000"/>
                              <Color>808000</Color>
                              <VariableType>Float</VariableType>
                              <Address>Stick_Threshold_XY</Address>
                            </CheatEntry>
                            <CheatEntry>
                              <ID>3072</ID>
                              <Description>"Stick_Threshold_Left Lv.1"</Description>
                              <LastState Value="??" Activated="0" RealAddress="00000000"/>
                              <Color>400080</Color>
                              <VariableType>Float</VariableType>
                              <Address>Stick_Threshold_XY+4</Address>
                            </CheatEntry>
                          </CheatEntries>
                        </CheatEntry>
                        <CheatEntry>
                          <ID>3073</ID>
                          <Description>"Level 2 Exponential"</Description>
                          <LastState Value="" Activated="0" RealAddress="00000000"/>
                          <Color>80000008</Color>
                          <GroupHeader>1</GroupHeader>
                          <CheatEntries>
                            <CheatEntry>
                              <ID>3074</ID>
                              <Description>"Stick_Threshold_Right Lv.2"</Description>
                              <LastState Value="??" Activated="0" RealAddress="00000000"/>
                              <Color>808000</Color>
                              <VariableType>Float</VariableType>
                              <Address>Stick_Threshold_XY+8</Address>
                            </CheatEntry>
                            <CheatEntry>
                              <ID>3075</ID>
                              <Description>"Stick_Threshold_Left Lv.2"</Description>
                              <LastState Value="??" Activated="0" RealAddress="00000000"/>
                              <Color>400080</Color>
                              <VariableType>Float</VariableType>
                              <Address>Stick_Threshold_XY+c</Address>
                            </CheatEntry>
                          </CheatEntries>
                        </CheatEntry>
                      </CheatEntries>
                    </CheatEntry>
                  </CheatEntries>
                </CheatEntry>
                <CheatEntry>
                  <ID>3076</ID>
                  <Description>"Debug/Stores"</Description>
                  <Options moHideChildren="1" moManualExpandCollapse="1"/>
                  <LastState Value="" Activated="0" RealAddress="00000000"/>
                  <Color>C0C0C0</Color>
                  <GroupHeader>1</GroupHeader>
                  <CheatEntries>
                    <CheatEntry>
                      <ID>3081</ID>
                      <Description>"Master_360"</Description>
                      <LastState Value="??" Activated="0" RealAddress="00000000"/>
                      <Color>80000008</Color>
                      <VariableType>Float</VariableType>
                      <Address>Master_360</Address>
                    </CheatEntry>
                    <CheatEntry>
                      <ID>3155</ID>
                      <Description>"Tail_Cam_Seal"</Description>
                      <LastState Value="??" Activated="0" RealAddress="00000000"/>
                      <Color>80000008</Color>
                      <VariableType>Byte</VariableType>
                      <Address>Tail_Cam_Seal</Address>
                      <Hotkeys>
                        <Hotkey>
                          <Action>Increase Value</Action>
                          <Keys>
                            <Key>190</Key>
                          </Keys>
                          <Value>2</Value>
                          <ID>0</ID>
                        </Hotkey>
                        <Hotkey>
                          <Action>Decrease Value</Action>
                          <Keys>
                            <Key>188</Key>
                          </Keys>
                          <Value>2</Value>
                          <ID>1</ID>
                        </Hotkey>
                      </Hotkeys>
                    </CheatEntry>
                    <CheatEntry>
                      <ID>3077</ID>
                      <Description>"Stored Xmm Registers"</Description>
                      <Options moHideChildren="1" moManualExpandCollapse="1"/>
                      <LastState Value="" Activated="0" RealAddress="00000000"/>
                      <Color>80000008</Color>
                      <GroupHeader>1</GroupHeader>
                      <CheatEntries>
                        <CheatEntry>
                          <ID>3078</ID>
                          <Description>"Xmm10"</Description>
                          <LastState Value="??" Activated="0" RealAddress="00000000"/>
                          <Color>80000008</Color>
                          <VariableType>Float</VariableType>
                          <Address>Xmm_Registers_Rotation</Address>
                        </CheatEntry>
                        <CheatEntry>
                          <ID>3079</ID>
                          <Description>"Xmm11"</Description>
                          <LastState Value="??" Activated="0" RealAddress="00000000"/>
                          <Color>80000008</Color>
                          <VariableType>Float</VariableType>
                          <Address>Xmm_Registers_Rotation+4</Address>
                        </CheatEntry>
                        <CheatEntry>
                          <ID>3080</ID>
                          <Description>"Xmm15"</Description>
                          <LastState Value="??" Activated="0" RealAddress="00000000"/>
                          <Color>80000008</Color>
                          <VariableType>Float</VariableType>
                          <Address>Xmm_Registers_Rotation+8</Address>
                        </CheatEntry>
                      </CheatEntries>
                    </CheatEntry>
                    <CheatEntry>
                      <ID>3083</ID>
                      <Description>"Breakpoint Display"</Description>
                      <LastState Value="??" Activated="0" RealAddress="0013E8E0"/>
                      <Color>80000008</Color>
                      <VariableType>Float</VariableType>
                      <Address>13E8E0</Address>
                    </CheatEntry>
                  </CheatEntries>
                </CheatEntry>
              </CheatEntries>
            </CheatEntry>
            <CheatEntry>
              <ID>3038</ID>
              <Description>"Camera Master Rotation (Assist Script)"</Description>
              <Options moManualExpandCollapse="1"/>
              <LastState Activated="0"/>
              <Color>FF8000</Color>
              <VariableType>Auto Assembler Script</VariableType>
              <AssemblerScript>{ Game   : Darksiders2.exe
  Version: 
  Date   : 2016-01-01
  Author : Akuma

  This script does blah blah blah
}

[ENABLE]

aobscanmodule(Death_Camera_Normal_Rotation_ret,Darksiders2.exe,F3 0F 11 81 60 0A 00 00 48 8B 4D 67) // should be unique
alloc(newmem,$1000,"Darksiders2.exe"+2D6792)

alloc(Death_Camera_Normal_Rotation,256)
registersymbol(Death_Camera_Normal_Rotation)

alloc(Flip_Neg_180_360,24)
registersymbol(Flip_Neg_180_360)

alloc(Cam_360,4)
registersymbol(Cam_360)

label(negative)
label(zero)
label(check_copy)
label(copy_to_Oni_rotate)
label(out)
label(return)

Flip_Neg_180_360:
dd (float)0

Flip_Neg_180_360+4:
dd (float)-1

Flip_Neg_180_360+8:
dd (float)360


//////////////////// rcx is death / input


Death_Camera_Normal_Rotation:
    movss xmm12,xmm2
     comiss xmm12,[Flip_Neg_180_360]
      jb negative
            movss [Cam_360],xmm12
   jmp check_copy


negative:
   addss xmm12,[Flip_Neg_180_360+8]
    jmp zero



zero:
  movss [Cam_360],xmm12
   jmp check_copy


check_copy:
  cmp byte ptr [rcx+00000a99],00        // if no l2 held copy
   je copy_to_Oni_rotate
   jne out

copy_to_Oni_rotate:
   movss [Outside_Rotation_Lock],xmm12
   jmp out




newmem:
out:
  movss [rcx+00000A60],xmm0
  jmp return

Death_Camera_Normal_Rotation_ret:
  jmp Death_Camera_Normal_Rotation
  nop
  nop
  nop
return:
registersymbol(Death_Camera_Normal_Rotation_ret)

[DISABLE]

Death_Camera_Normal_Rotation_ret:
  db F3 0F 11 81 60 0A 00 00

unregistersymbol(Death_Camera_Normal_Rotation_ret)
dealloc(newmem)

{
// ORIGINAL CODE - INJECTION POINT: "Darksiders2.exe"+2D6792

"Darksiders2.exe"+2D6766: FF 90 F8 00 00 00        -  call qword ptr [rax+000000F8]
"Darksiders2.exe"+2D676C: 4C 8D 45 E7              -  lea r8,[rbp-19]
"Darksiders2.exe"+2D6770: 48 8D 55 F7              -  lea rdx,[rbp-09]
"Darksiders2.exe"+2D6774: 48 8D 4D 07              -  lea rcx,[rbp+07]
"Darksiders2.exe"+2D6778: E8 53 13 EC FF           -  call Darksiders2.exe+197AD0
"Darksiders2.exe"+2D677D: 48 8B 4B 18              -  mov rcx,[rbx+18]
"Darksiders2.exe"+2D6781: 48 8D 55 67              -  lea rdx,[rbp+67]
"Darksiders2.exe"+2D6785: E8 E6 F0 DE FF           -  call Darksiders2.exe+C5870
"Darksiders2.exe"+2D678A: F3 0F 10 45 EF           -  movss xmm0,[rbp-11]
"Darksiders2.exe"+2D678F: 48 8B 08                 -  mov rcx,[rax]
// ---------- INJECTING HERE ----------
"Darksiders2.exe"+2D6792: F3 0F 11 81 60 0A 00 00  -  movss [rcx+00000A60],xmm0
// ---------- DONE INJECTING  ----------
"Darksiders2.exe"+2D679A: 48 8B 4D 67              -  mov rcx,[rbp+67]
"Darksiders2.exe"+2D679E: 48 85 C9                 -  test rcx,rcx
"Darksiders2.exe"+2D67A1: 74 17                    -  je Darksiders2.exe+2D67BA
"Darksiders2.exe"+2D67A3: F0 FF 49 08              - lock  dec [rcx+08]
"Darksiders2.exe"+2D67A7: 75 11                    -  jne Darksiders2.exe+2D67BA
"Darksiders2.exe"+2D67A9: C7 41 08 AD DE AD DE     -  mov [rcx+08],DEADDEAD
"Darksiders2.exe"+2D67B0: 48 8B 01                 -  mov rax,[rcx]
"Darksiders2.exe"+2D67B3: BA 01 00 00 00           -  mov edx,00000001
"Darksiders2.exe"+2D67B8: FF 10                    -  call qword ptr [rax]
"Darksiders2.exe"+2D67BA: 48 8B 4B 18              -  mov rcx,[rbx+18]
}
</AssemblerScript>
              <CheatEntries>
                <CheatEntry>
                  <ID>3039</ID>
                  <Description>"Master Camera Rotation"</Description>
                  <LastState Value="??" Activated="0" RealAddress="00000000"/>
                  <Color>1147A2</Color>
                  <VariableType>Float</VariableType>
                  <Address>Cam_360</Address>
                </CheatEntry>
                <CheatEntry>
                  <ID>3117</ID>
                  <Description>"Breakpoint Display"</Description>
                  <LastState Value="??" Activated="0" RealAddress="0013ED28"/>
                  <Color>1147A2</Color>
                  <VariableType>Float</VariableType>
                  <Address>000000000013ED28</Address>
                </CheatEntry>
              </CheatEntries>
            </CheatEntry>
            <CheatEntry>
              <ID>2928</ID>
              <Description>"Disable Lock On Exit with R3"</Description>
              <LastState Activated="0"/>
              <Color>FF8000</Color>
              <VariableType>Auto Assembler Script</VariableType>
              <AssemblerScript>{ Game   : Darksiders2.exe
  Version: 
  Date   : 2015-12-29
  Author : Akuma

  This script does blah blah blah
}

[ENABLE]

aobscanmodule(Lock_On_Aim_Mode_R3_Exclusion,Darksiders2.exe,80 BB 9E 0A 00 00 00 74 1A) // should be unique
alloc(newmem,$1000,"Darksiders2.exe"+238010)

alloc(Zero_Flag_r3,1)
registersymbol(Zero_Flag_r3)

label(code)
label(zero_flag)
label(originalcode)
label(return)

newmem:
code:
  cmp byte ptr [rbx+00000A99],01
  jmp zero_flag

zero_flag:
  cmp [Zero_Flag_r3],0               // forcing flag
  jmp return


originalcode:
  cmp byte ptr [rbx+00000A9E],00
  jmp return

Lock_On_Aim_Mode_R3_Exclusion:
  jmp code
  nop
  nop
return:
registersymbol(Lock_On_Aim_Mode_R3_Exclusion)

[DISABLE]

Lock_On_Aim_Mode_R3_Exclusion:
  db 80 BB 9E 0A 00 00 00

unregistersymbol(Lock_On_Aim_Mode_R3_Exclusion)
dealloc(newmem)

{
// ORIGINAL CODE - INJECTION POINT: "Darksiders2.exe"+238010

"Darksiders2.exe"+237FEB: 75 19                    -  jne Darksiders2.exe+238006
"Darksiders2.exe"+237FED: F3 0F 10 15 5F F1 3E 01  -  movss xmm2,[Darksiders2.exe+1627154]
"Darksiders2.exe"+237FF5: F3 0F 10 CA              -  movss xmm1,xmm2
"Darksiders2.exe"+237FF9: 48 8B 4F 38              -  mov rcx,[rdi+38]
"Darksiders2.exe"+237FFD: E8 F2 0D 0A 00           -  call Darksiders2.exe+2D8DF4
"Darksiders2.exe"+238002: 84 C0                    -  test al,al
"Darksiders2.exe"+238004: 75 28                    -  jne Darksiders2.exe+23802E
"Darksiders2.exe"+238006: 48 8B 47 40              -  mov rax,[rdi+40]
"Darksiders2.exe"+23800A: 80 78 28 00              -  cmp byte ptr [rax+28],00
"Darksiders2.exe"+23800E: 74 23                    -  je Darksiders2.exe+238033
// ---------- INJECTING HERE ----------
"Darksiders2.exe"+238010: 80 BB 9E 0A 00 00 00     -  cmp byte ptr [rbx+00000A9E],00
// ---------- DONE INJECTING  ----------
"Darksiders2.exe"+238017: 74 1A                    -  je Darksiders2.exe+238033
"Darksiders2.exe"+238019: F3 0F 10 0D 33 F1 3E 01  -  movss xmm1,[Darksiders2.exe+1627154]
"Darksiders2.exe"+238021: 48 8B 4F 38              -  mov rcx,[rdi+38]
"Darksiders2.exe"+238025: E8 B2 10 0A 00           -  call Darksiders2.exe+2D90DC
"Darksiders2.exe"+23802A: 84 C0                    -  test al,al
"Darksiders2.exe"+23802C: 74 05                    -  je Darksiders2.exe+238033
"Darksiders2.exe"+23802E: 40 B7 01                 -  mov dil,01
"Darksiders2.exe"+238031: EB 0E                    -  jmp Darksiders2.exe+238041
"Darksiders2.exe"+238033: 0F 28 CF                 -  movaps xmm1,xmm7
"Darksiders2.exe"+238036: 48 8B CF                 -  mov rcx,rdi
}
</AssemblerScript>
            </CheatEntry>
            <CheatEntry>
              <ID>3186</ID>
              <Description>"________________                                Oni Style Lock Camera Adjust End               _______________________"</Description>
              <LastState Value="" Activated="0" RealAddress="00000000"/>
              <Color>DDA58C</Color>
              <GroupHeader>1</GroupHeader>
            </CheatEntry>
          </CheatEntries>
        </CheatEntry>
      </CheatEntries>
    </CheatEntry>
    <CheatEntry>
      <ID>3192</ID>
      <Description>"Copy And Paste on Main Table "</Description>
      <LastState Value="" Activated="0" RealAddress="00000000"/>
      <Color>80000008</Color>
      <GroupHeader>1</GroupHeader>
    </CheatEntry>
    <CheatEntry>
      <ID>3193</ID>
      <Description>"Some Sripts Use [Death Stat] for button loads"</Description>
      <LastState Value="" Activated="0" RealAddress="00000000"/>
      <Color>80000008</Color>
      <GroupHeader>1</GroupHeader>
    </CheatEntry>
    <CheatEntry>
      <ID>3194</ID>
      <Description>"Do not DeActivate       "Oni Telescope"  group I have a bug "</Description>
      <LastState Value="" Activated="0" RealAddress="00000000"/>
      <Color>80000008</Color>
      <GroupHeader>1</GroupHeader>
    </CheatEntry>
  </CheatEntries>
  <UserdefinedSymbols/>
</CheatTable>
