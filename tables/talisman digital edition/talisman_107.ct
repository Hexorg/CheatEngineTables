<?xml version="1.0" encoding="utf-8"?>
<CheatTable CheatEngineTableVersion="19">
  <CheatEntries>
    <CheatEntry>
      <ID>7</ID>
      <Description>"Talisman Base Address"</Description>
      <ShowAsHex>1</ShowAsHex>
      <VariableType>Byte</VariableType>
      <Address>talisman.s86</Address>
    </CheatEntry>
    <CheatEntry>
      <ID>5</ID>
      <Description>"Player 1"</Description>
      <Options moHideChildren="1"/>
      <LastState Value="" Activated="1" RealAddress="00000000"/>
      <GroupHeader>1</GroupHeader>
      <CheatEntries>
        <CheatEntry>
          <ID>0</ID>
          <Description>"Life"</Description>
          <Color>00FF00</Color>
          <VariableType>4 Bytes</VariableType>
          <Address>talisman.s86+64D354</Address>
        </CheatEntry>
        <CheatEntry>
          <ID>3</ID>
          <Description>"Strength"</Description>
          <Color>0000CC</Color>
          <VariableType>4 Bytes</VariableType>
          <Address>talisman.s86+64D358</Address>
        </CheatEntry>
        <CheatEntry>
          <ID>2</ID>
          <Description>"Craft"</Description>
          <Color>9B4E00</Color>
          <VariableType>4 Bytes</VariableType>
          <Address>talisman.s86+64D35C</Address>
        </CheatEntry>
        <CheatEntry>
          <ID>1</ID>
          <Description>"Fate"</Description>
          <Color>800080</Color>
          <VariableType>4 Bytes</VariableType>
          <Address>talisman.s86+64D360</Address>
        </CheatEntry>
        <CheatEntry>
          <ID>4</ID>
          <Description>"Gold"</Description>
          <Color>00B0B0</Color>
          <VariableType>4 Bytes</VariableType>
          <Address>talisman.s86+64D364</Address>
        </CheatEntry>
      </CheatEntries>
    </CheatEntry>
    <CheatEntry>
      <ID>12</ID>
      <Description>"Player 2"</Description>
      <Options moHideChildren="1"/>
      <LastState Value="" RealAddress="00000000"/>
      <GroupHeader>1</GroupHeader>
      <CheatEntries>
        <CheatEntry>
          <ID>6</ID>
          <Description>"Life"</Description>
          <Color>00FF00</Color>
          <VariableType>4 Bytes</VariableType>
          <Address>talisman.s86+64E380</Address>
        </CheatEntry>
        <CheatEntry>
          <ID>8</ID>
          <Description>"Strength"</Description>
          <Color>0000CC</Color>
          <VariableType>4 Bytes</VariableType>
          <Address>talisman.s86+64E384</Address>
        </CheatEntry>
        <CheatEntry>
          <ID>9</ID>
          <Description>"Craft"</Description>
          <Color>9B4E00</Color>
          <VariableType>4 Bytes</VariableType>
          <Address>talisman.s86+64E388</Address>
        </CheatEntry>
        <CheatEntry>
          <ID>10</ID>
          <Description>"Fate"</Description>
          <Color>800080</Color>
          <VariableType>4 Bytes</VariableType>
          <Address>talisman.s86+64E38C</Address>
        </CheatEntry>
        <CheatEntry>
          <ID>11</ID>
          <Description>"Gold"</Description>
          <Color>00B0B0</Color>
          <VariableType>4 Bytes</VariableType>
          <Address>talisman.s86+64E390</Address>
        </CheatEntry>
      </CheatEntries>
    </CheatEntry>
    <CheatEntry>
      <ID>14</ID>
      <Description>"Player 3"</Description>
      <Options moHideChildren="1"/>
      <LastState Value="" RealAddress="00000000"/>
      <GroupHeader>1</GroupHeader>
      <CheatEntries>
        <CheatEntry>
          <ID>13</ID>
          <Description>"Life"</Description>
          <Color>00FF00</Color>
          <VariableType>4 Bytes</VariableType>
          <Address>talisman.s86+64F3AC</Address>
        </CheatEntry>
        <CheatEntry>
          <ID>15</ID>
          <Description>"Strength"</Description>
          <Color>0000CC</Color>
          <VariableType>4 Bytes</VariableType>
          <Address>talisman.s86+64F3B0</Address>
        </CheatEntry>
        <CheatEntry>
          <ID>16</ID>
          <Description>"Craft"</Description>
          <Color>9B4E00</Color>
          <VariableType>4 Bytes</VariableType>
          <Address>talisman.s86+64F3B4</Address>
        </CheatEntry>
        <CheatEntry>
          <ID>17</ID>
          <Description>"Fate"</Description>
          <Color>800080</Color>
          <VariableType>4 Bytes</VariableType>
          <Address>talisman.s86+64F3B8</Address>
        </CheatEntry>
        <CheatEntry>
          <ID>18</ID>
          <Description>"Gold"</Description>
          <Color>00B0B0</Color>
          <VariableType>4 Bytes</VariableType>
          <Address>talisman.s86+64F3BC</Address>
        </CheatEntry>
      </CheatEntries>
    </CheatEntry>
    <CheatEntry>
      <ID>20</ID>
      <Description>"Player 4"</Description>
      <Options moHideChildren="1"/>
      <LastState Value="" RealAddress="00000000"/>
      <GroupHeader>1</GroupHeader>
      <CheatEntries>
        <CheatEntry>
          <ID>19</ID>
          <Description>"Life"</Description>
          <Color>00FF00</Color>
          <VariableType>4 Bytes</VariableType>
          <Address>talisman.s86+6503D8</Address>
        </CheatEntry>
        <CheatEntry>
          <ID>21</ID>
          <Description>"Strength"</Description>
          <Color>0000CC</Color>
          <VariableType>4 Bytes</VariableType>
          <Address>talisman.s86+6503DC</Address>
        </CheatEntry>
        <CheatEntry>
          <ID>22</ID>
          <Description>"Craft"</Description>
          <Color>9B4E00</Color>
          <VariableType>4 Bytes</VariableType>
          <Address>talisman.s86+6503E0</Address>
        </CheatEntry>
        <CheatEntry>
          <ID>23</ID>
          <Description>"Fate"</Description>
          <Color>800080</Color>
          <VariableType>4 Bytes</VariableType>
          <Address>talisman.s86+6503E4</Address>
        </CheatEntry>
        <CheatEntry>
          <ID>24</ID>
          <Description>"Gold"</Description>
          <Color>00B0B0</Color>
          <VariableType>4 Bytes</VariableType>
          <Address>talisman.s86+6503E8</Address>
        </CheatEntry>
      </CheatEntries>
    </CheatEntry>
    <CheatEntry>
      <ID>31</ID>
      <Description>"Misc"</Description>
      <Options moHideChildren="1"/>
      <LastState Activated="1"/>
      <VariableType>Auto Assembler Script</VariableType>
      <AssemblerScript>[ENABLE]

aobscanmodule(RollDice,talisman.s86,8B 47 40 83 F8 06) // should be unique
alloc(newmem,$1000)

label(code)
label(return)
globalalloc(_roll,4)

newmem:

code:
  mov [_roll],edi
  mov eax,[edi+40]
  cmp eax,06
  jmp return

RollDice:
  jmp code
  nop
return:
registersymbol(RollDice)

[DISABLE]

RollDice:
  db 8B 47 40 83 F8 06

unregistersymbol(RollDice)
dealloc(newmem)

{
// ORIGINAL CODE - INJECTION POINT: "talisman.s86"+2FF717

"talisman.s86"+2FF6F5: 56                             -  push esi
"talisman.s86"+2FF6F6: 8B F1                          -  mov esi,ecx
"talisman.s86"+2FF6F8: 74 05                          -  je talisman.s86+2FF6FF
"talisman.s86"+2FF6FA: E8 51 E8 01 00                 -  call talisman.s86+31DF50
"talisman.s86"+2FF6FF: 33 DB                          -  xor ebx,ebx
"talisman.s86"+2FF701: 39 9E 2C 02 00 00              -  cmp [esi+0000022C],ebx
"talisman.s86"+2FF707: 0F 8E A1 00 00 00              -  jng talisman.s86+2FF7AE
"talisman.s86"+2FF70D: 57                             -  push edi
"talisman.s86"+2FF70E: 8D BE B8 01 00 00              -  lea edi,[esi+000001B8]
"talisman.s86"+2FF714: 8D 4B 01                       -  lea ecx,[ebx+01]
// ---------- INJECTING HERE ----------
"talisman.s86"+2FF717: 8B 47 40                       -  mov eax,[edi+40]
"talisman.s86"+2FF71A: 83 F8 06                       -  cmp eax,06
// ---------- DONE INJECTING  ----------
"talisman.s86"+2FF71D: 7E 07                          -  jle talisman.s86+2FF726
"talisman.s86"+2FF71F: B8 06 00 00 00                 -  mov eax,00000006
"talisman.s86"+2FF724: EB 06                          -  jmp talisman.s86+2FF72C
"talisman.s86"+2FF726: 83 F8 01                       -  cmp eax,01
"talisman.s86"+2FF729: 0F 4C C1                       -  cmovl eax,ecx
"talisman.s86"+2FF72C: 50                             -  push eax
"talisman.s86"+2FF72D: 8D 45 DC                       -  lea eax,[ebp-24]
"talisman.s86"+2FF730: 68 A0 57 AD 09                 -  push talisman.s86+4C57A0
"talisman.s86"+2FF735: 50                             -  push eax
"talisman.s86"+2FF736: E8 95 31 E3 FF                 -  call talisman.s86+1328D0
}
</AssemblerScript>
      <CheatEntries>
        <CheatEntry>
          <ID>29</ID>
          <Description>"Dice Roll (Read-Only/Fake)"</Description>
          <VariableType>4 Bytes</VariableType>
          <Address>_roll</Address>
          <Offsets>
            <Offset>40</Offset>
          </Offsets>
        </CheatEntry>
      </CheatEntries>
    </CheatEntry>
  </CheatEntries>
  <UserdefinedSymbols>
    <SymbolEntry>
      <Name>_playerbase</Name>
      <Address>00C40000</Address>
    </SymbolEntry>
    <SymbolEntry>
      <Name>playerbase</Name>
      <Address>00C40010</Address>
    </SymbolEntry>
    <SymbolEntry>
      <Name>hpreading</Name>
      <Address>0D2F8A8F</Address>
    </SymbolEntry>
    <SymbolEntry>
      <Name>_inventorybase</Name>
      <Address>00C40020</Address>
    </SymbolEntry>
    <SymbolEntry>
      <Name>goldreading</Name>
      <Address>0D2F8A3A</Address>
    </SymbolEntry>
    <SymbolEntry>
      <Name>_rollbase</Name>
      <Address>00A10010</Address>
    </SymbolEntry>
    <SymbolEntry>
      <Name>DiceRoll</Name>
      <Address> 09916BD6</Address>
    </SymbolEntry>
    <SymbolEntry>
      <Name>_roll</Name>
      <Address>0E810000</Address>
    </SymbolEntry>
    <SymbolEntry>
      <Name>RollDice</Name>
      <Address> 09D5F717</Address>
    </SymbolEntry>
  </UserdefinedSymbols>
</CheatTable>
