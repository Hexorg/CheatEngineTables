<?xml version="1.0" encoding="utf-8"?>
<CheatTable CheatEngineTableVersion="18">
  <CheatEntries>
    <CheatEntry>
      <ID>87</ID>
      <Description>"[X] &lt;== Rome Total War v1.51 Steam Script v5.0"</Description>
      <Options moHideChildren="1"/>
      <LastState Activated="0"/>
      <Color>FF0000</Color>
      <VariableType>Auto Assembler Script</VariableType>
      <AssemblerScript>{
===========================================
 Game Title    : Rome Total War
 Game Version  : 1.51
 Game Sponsor  : Myself and other Guys (via donation)
 Proces Name   : RomeTW.exe
 Script Version: 5.0
 CE Version    : 6.4
 Release date  : 05-Oct-2014
 Author        : Recifense
 History:
 01-Mar-12: First Release (CE6.1)
 27-Jan-13: Modified GM approach + New Features (Script 3.0)
 10-Feb-13: New Features (Script 4.0)
 24-Feb-13: Killing a bug on MOS (Script 4.1)
 05-Oct-14: Release for version 1.51 (Steam) (CE6.4) (S50)
 Features:
 - God Mode + Revival
 - Unlimited Ammo (now it includes cannon ammo)
 - Unlimited Stamina                        (new)
 - Minimum Gold
 - Unlimited Movement Points
   - Army
   - Troop
   - Agents
 - Recover Troop Size (when moving)
 - Construction in 1 day
 - Officers' and Special Agents' Attributes (new)
 - Minimum Available Units (for recruitment)(new)
 - Minimum Available Mercenaries (for hire) (new)
 - Pointer to selected city
===========================================
}

//=========================================
// Definitions
define(LUDO,"RomeTW.exe")
define(MHID,RomeTW.exe+007d4ef4)
define(MOBE,RomeTW.exe+003b7b86)
define(GMDA,RomeTW.exe+00353c77)
define(GMDS,RomeTW.exe+0002cd64)
define(GMDC,RomeTW.exe+0002bd56)
define(GMDK,RomeTW.exe+0045cbba)
define(GMDR,RomeTW.exe+004790ec)
define(MOUS,RomeTW.exe+0043bfd1)
define(MOAC,RomeTW.exe+0044b9c7)
define(MOAT,RomeTW.exe+003c2d4d)

define(MHPR,RomeTW.exe+008985ed)
define(MMPA,RomeTW.exe+0018165a)
define(MMPO,RomeTW.exe+001816bb)
define(MMPT,RomeTW.exe+003c115c)
define(MOOS,RomeTW.exe+0084b9e8)
define(MOAM,RomeTW.exe+00876627)
define(MOSC,RomeTW.exe+000bbd77)
define(MOCN,RomeTW.exe+001d9361)
define(MOPO,RomeTW.exe+001cdb15)

define(RMDS,RomeTW.exe+00029dfb)
define(ROAM,RomeTW.exe+008749db)

//=========================================
// Constants used in the script (that can be changed)
define(ctCE64,(float)6.4)
define(ctMMON,#64000)  // Minimum Money
define(ctMATT,#10)     // Minimum Attributes

//=========================================
[ENABLE]
//=========================================
//LuaCall(CheckVersion())
//=========================================
// Check if script is compatible to this game version
// If false the script will not be loaded
// RTS:
assert(MHID,8b 80 d8 00 00 00 8b 40 2c 89 85 2c ff ff ff 83 bd 2c ff ff ff)
assert(MOBE,83 a0 88 02 00 00 00 83 65 84 00 83 65 fc 00 ?? ?? 8b 45 fc 40)
assert(GMDA,8b 04 88 89 45 fc 8b 45 fc 05 80 03 00 00 89 45 f4 8b 45 f4 8b)
assert(GMDS,55 8b ec 81 ec 74 02 00 00 53 56 57 89 8d b8 fd ff ff 83 7d 08)
assert(GMDC,8b 45 0c 8b 40 60 89 45 f0 8b 45 f0 2b 45 10 8b 4d 0c 89 41 60)
assert(GMDK,55 8b ec 83 ec 2c 89 4d d8 8b 45 d8 8b 80 64 02 00 00 83 e0 fd)
assert(GMDR,55 8b ec 81 ec 98 04 00 00 89 8d 90 fb ff ff 8b 85 90 fb ff ff)
assert(MOUS,66 89 88 5a 02 00 00 8b 45 cc 0f b7 80 5a 02 00 00 6a 06 59 d1)
assert(MOAC,89 81 e0 03 00 00 8b 45 f4 80 a0 78 04 00 00 00 c9 c3 55 8b ec)
assert(MOAT,89 81 5c 09 00 00 c9 c3 55 8b ec 51 89 4d fc 8b 45 fc 8b 80 5c)
// TBS:
assert(MHPR,8b 80 04 05 00 00 89 45 f0 ff 75 f0 8b 45 ec 8b 48 60 8b 45 ec)
assert(MMPA,d9 80 c4 00 00 00 d8 65 08 8b 45 8c d9 98 c4 00 00 00 8b 45 8c)
assert(MMPO,d9 98 7c 02 00 00 0f b6 45 0c 85 c0 0f 84 ?? ?? ?? ?? 8b 45 8c)
assert(MMPT,d9 80 7c 02 00 00 d8 65 08 8b 45 fc d9 98 7c 02 00 00 8b 45 fc)
assert(MOOS,8b 40 78 89 45 b4 6a 00 ff 75 f8 ff 75 18 ff 75 b4 8b 45 9c 8b)
assert(MOAM,8b 80 d8 00 00 00 8b 40 14 89 45 e8 8b 45 e8 89 45 f8 83 65 f4)
assert(MOSC,89 48 3c 8b 45 0c 8b 00 8b 4d 0c ff 50 70 8b 40 04 89 45 8c 83)
assert(MOCN,8b 45 b0 8b 4d b0 8b 40 20 2b 41 24 89 45 f8 8b 45 f8 3b 45 08)
assert(MOPO,89 81 ac 00 00 00 8b 85 d4 fd ff ff 8b 40 04 8b 80 b4 01 00 00)

//=========================================
alloc(MyCode,4096,LUDO)
//=========================================
// Declaration section
label(_MonHumanID)
label(_BackMHI)
label(_ExitMHI)
label(_MonBattleEnd)
label(_BackMBE)
label(_ExitMBE)
label(_GodModeA)
label(_GodMA00)
label(_BackGMA)
label(_ExitGMA)
label(_GodModeS)
label(_BackGMS)
label(_ExitGMS)
label(_GodModeC)
label(_BackGMC)
label(_ExitGMC)
label(_GodModeK)
label(_BackGMK)
label(_ExitGMK)
label(_GodModeR)
label(_GodMR00)
label(_GodMR01)
label(_BackGMR)
label(_ExitGMR)
label(_MonUnitStamina)
label(_BackMUS)
label(_ExitMUS)
label(_MonAmmoC)
label(_BackMAC)
label(_ExitMAC)
label(_MonAmmoT)
label(_BackMAT)
label(_ExitMAT)
//---
label(_MonHumanPlayer)
label(_BackMHP)
label(_ExitMHP)
label(_MonMPA)
label(_BackMMA)
label(_ExitMMA)
label(_MonMPO)
label(_MonPO00)
label(_BackMMO)
label(_ExitMMO)
label(_MonMPT)
label(_MonPT00)
label(_BackMMT)
label(_ExitMMT)
label(_MonOfficerStatus)
label(_MonOS00)
label(_MonOS01)
label(_MonOS02)
label(_MonOS03)
label(_BackMOS)
label(_ExitMOS)
label(_MonAvailableMercs)
label(_MonAM00)
label(_BackMAM)
label(_ExitMAM)
label(_MonSelCity)
label(_BackMSC)
label(_ExitMSC)
label(_MonConstruction)
label(_BackMCN)
label(_ExitMCN)
label(_MonPublicOrder)
label(_BackCPO)
label(_ExitCPO)

label(iEnableGMD)
label(iEnableMUS)
label(iEnableMSU)
label(iEnableMAO)

label(iEnableMMG)
label(iEnableMMP)
label(iEnableMTS)
label(iEnableMOS)
label(iEnableMAM)
label(iEnableMCN)
label(iEnableMPO)
label(iEnableMTR)
label(iID)
label(iMAUC)
label(pUnit)
label(pCity)
label(pPlayer)
label(pOfficer)
label(aLast)
label(iCount)

//=========================================
// Registering Symbols
registersymbol(MyCode)
registersymbol(iEnableGMD)
registersymbol(iEnableMUS)
registersymbol(iEnableMSU)
registersymbol(iEnableMAO)
registersymbol(iEnableMMG)
registersymbol(iEnableMMP)
registersymbol(iEnableMTS)
registersymbol(iEnableMOS)
registersymbol(iEnableMAM)
registersymbol(iEnableMCN)
registersymbol(iEnableMPO)
registersymbol(iEnableMTR)
registersymbol(pUnit)
registersymbol(pCity)
registersymbol(pPlayer)
registersymbol(pOfficer)
registersymbol(aLast)
registersymbol(iCount)

//=========================================
MyCode:
//========================================= rtw
// RTS - When a player troop is selected
_MonHumanID:
 push ebx

 mov eax,[eax+000000D8]            // Original code

 mov ebx,[eax+5c]
 mov [iID],ebx

_ExitMHI:
 pop ebx
 jmp _BackMHI                      // Back to main code

//========================================= rtw
// RTS - On battle end
_MonBattleEnd:
 mov [iID],eax                     // Invalidate ID

_ExitMBE:
 and dword ptr [eax+00000288],00   // Original code (upd TroopSize)
 jmp _BackMBE                      // Back to main code

//========================================= rtw
// RTS - During battle
_GodModeA:
 push ebx

 mov eax,[eax+ecx*4]               // Original code
 mov [ebp-04],eax                  // Original code

 mov ebx,[ebp-08]

 mov [pUnit],ebx                   // Save ptr for debugging

 push eax
 mov eax,[iID]
 cmp eax,[ebx+5c]
 pop eax
 jne _ExitGMA

 cmp dword ptr [iEnableMSU],0
 je _GodMA00                       // Jump if feature is disabled

// turn the units stronger
 or byte ptr [ebx+000002d3],0F     // Charge Bonus
 mov byte ptr [ebx+000002f8],#120  // Attack
 mov byte ptr [ebx+000002f9],#120  // Armor

 test eax,eax                      // Valid?
 jz _GodMA00

 or byte ptr [eax+00000203],0F     // Charge Bonus
 mov byte ptr [eax+00000228],#120  // Attack
 mov byte ptr [eax+00000229],#120  // Armor

_GodMA00:
 cmp dword ptr [iEnableMAO],0
 je _ExitGMA                       // Jump if feature is disabled

 push eax
 mov eax,[ebx+00000958]
 mov [ebx+0000095c],eax
 pop eax

_ExitGMA:
 pop ebx
 jmp _BackGMA                      // Back to main code

//========================================= rtw
// RTS - GM for Soldiers
_GodModeS:
 mov [aLast],'_GMS'

 push ebx
 push ecx

 lea ecx,[ecx]                     // For debugging

// mov ebx,[esp+08]
// cmp ebx,RMDS
// je _ExitGMS                       // avoid if killed by arrow or cannon ball

 cmp dword ptr [iEnableGMD],0
 je _ExitGMS                       // Jump if feature is disabled

 test ecx,ecx
 jz _ExitGMS

 mov ecx,[ecx+04]
 test ecx,ecx
 jz _ExitGMS

 cmp ecx,[ecx+28]                  // Valid?
 jne _ExitGMS

 mov ebx,[ecx+00000308]
 test ebx,ebx
 jz _ExitGMS

 mov ebx,[ebx+5c]
 cmp ebx,[iID]
 jne _ExitGMS                      // Jump if it's not a player's troop

 pop ecx
 pop ebx
 ret 0024
//===
_ExitGMS:
 pop ecx
 pop ebx

 push ebp                          // Original code
 mov ebp,esp                       // Original code
 sub esp,00000274                  // Original code
 jmp _BackGMS                      // Back to main code

//========================================= rtw
// RTS - Cannons
_GodModeC:
 mov [aLast],'_GMC'

 cmp dword ptr [iEnableGMD],0
 je _ExitGMC                       // Jump if feature is disabled

 mov eax,[ebp+0C]                  // get cannon
 test eax,eax
 jz _ExitGMC

 mov eax,[eax+6C]                  // pTroop
 test eax,eax
 jz _ExitGMC

 push ebx
 mov ebx,[iID]
 cmp ebx,[eax+5c]
 pop ebx
 jne _ExitGMC                      // Jump if it's a player's troop

 xor eax,eax
 mov [ebp+10],eax                  // Value2decrease = 0

_ExitGMC:
 mov eax,[ebp+0C]                  // Original code (get cannon)
 mov eax,[eax+60]                  // Original code (get cHP)
 jmp _BackGMC                      // Back to main code

//========================================= rtw
// RTS - Cannons
_GodModeK:
 mov [aLast],'_GMK'

 push eax

 cmp dword ptr [iEnableGMD],0
 je _ExitGMK                       // Jump if feature is disabled

 mov eax,[ecx+6C]                  // pTroop
 test eax,eax
 jz _ExitGMK

 push ebx
 mov ebx,[iID]
 cmp ebx,[eax+5c]
 pop ebx
 je _ExitGMK                       // Jump if it's a player's troop

 pop eax
 ret
//====
_ExitGMK:
 pop eax

 push ebp                          // Original code
 mov ebp,esp                       // Original code
 sub esp,2C                        // Original code
 jmp _BackGMK                      // Back to main code

//========================================= rtw
// RTS - Soldiers (killed by arrows or cannon balls)
_GodModeR:
 mov [aLast],'_GMR'

 push eax
 push ecx

 lea ecx,[ecx]                     // For debugging

 cmp dword ptr [iEnableGMD],0
 je _ExitGMR                       // Jump if feature is disabled

_GodMR00:
 inc dword ptr [iCount]

 mov ecx,[ecx+10]                  // Get pTroop
 test ecx,ecx
 jz _ExitGMR

 dec dword ptr [iCount]

_GodMR01:
 mov eax,[ecx+5c]
 cmp eax,[iID]
 je _ExitGMR                       // Jump if it's a player's troop

 mov eax,[ecx+00000984]
 test eax,eax
 jz _ExitGMR                       //  jump if it is not a cannon

 cmp eax,#5
 jge _ExitGMR

 pop ecx
 pop eax
 ret
//----
_ExitGMR:
 pop ecx
 pop eax

 push ebp                          // Original code
 mov ebp,esp                       // Original code
 sub esp,00000498                  // Original code
 jmp _BackGMR                      // Back to main code

//========================================= rtw
// RTS - Soldiers (when changing)
_MonUnitStamina:
 push ebx
 push esi

 cmp dword ptr [iEnableMUS],0
 je _ExitMUS                       // Jump if feature is disabled

 mov esi,[eax+00000308]            // Get Troop

 mov ebx,[iID]
 cmp ebx,[esi+5c]
 jne _ExitMUS                      // Jump if it's not a player's troop

 xor ecx,ecx

_ExitMUS:
 pop esi
 pop ebx

 mov [eax+0000025A],cx             // Original code
 jmp _BackMUS                      // Back to main code

//========================================= rtw
// RTS - Cannons (all the time)
_MonAmmoC:
 push ebx

 mov [aLast],'_MAC'

 cmp dword ptr [iEnableMAO],0
 je _ExitMAC                       // Jump if feature is disabled

 mov ebx,[ecx+6C]                  // Get pTroop
 test ebx,ebx
 jz _ExitMAC

 mov ebx,[ebx+5c]
 cmp ebx,[iID]
 jne _ExitMAC                      // Jump if it's a player's troop

 mov eax,[ecx+000003e4]            // Get max ammo

_ExitMAC:
 pop ebx

 mov [ecx+000003E0],eax            // Original code
 jmp _BackMAC                      // Back to main code

//========================================= rtw
// RTS - Troops
_MonAmmoT:
 mov [aLast],'_MAT'

 cmp dword ptr [iEnableMAO],0
 je _ExitMAT                       // Jump if feature is disabled

 push ebx
 mov ebx,[iID]
 cmp ebx,[ecx+5c]
 pop ebx
 jne _ExitMAT                      // Jump if it's a player's troop

 mov eax,[ecx+00000958]            // Get max ammo

_ExitMAT:
 mov [ecx+0000095C],eax            // Original code
 jmp _BackMAT                      // Back to main code

//---------------------------------------------------------------------------
//========================================= rtw
// TBS - Main Screen (all the time)
_MonHumanPlayer:
 mov [pPlayer],eax

 cmp dword ptr [iEnableMMG],0
 je _ExitMHP                       // Jump if feature is disabled

 cmp dword ptr [eax+00000504],ctMMON
 jge _ExitMHP

 mov dword ptr [eax+00000504],ctMMON

_ExitMHP:
 mov eax,[eax+00000504]            // Original code (rd Gold)
 jmp _BackMHP                      // Back to main code

//========================================= rtw
// TBS - When moving (Army or Special Units)
_MonMPA:
 mov [aLast],'_MPA'

 push ebx

 cmp dword ptr [iEnableMMP],0
 je _ExitMMA                       // Jump if feature is disabled

 mov ebx,[eax+7c]
 test ebx,ebx
 jz _ExitMMA

 mov ebx,[ebx]
 cmp ebx,[pPlayer]
 jne _ExitMMA

 xor ebx,ebx
 mov [ebp+08],ebx                  // value2decrease = 0

 mov ebx,(float)80
 cmp ebx,[eax+000000C4]
 jle _ExitMMA

 mov [eax+000000C4],ebx

_ExitMMA:
 pop ebx

 fld dword ptr [eax+000000C4]      // Original code (get MP)
 jmp _BackMMA                      // Back to main code

//========================================= rtw
// TBS - When moving (Officers)
_MonMPO:
 mov [aLast],'_MPO'

 push ebx

 cmp dword ptr [iEnableMMP],0
 je _ExitMMO                       // Jump if feature is disabled

 mov ebx,[eax+40]                  // Get pArmy
 test ebx,ebx
 jz _ExitMMO

 mov ebx,[ebx+54]
 cmp ebx,[pPlayer]
 jne _ExitMMO

 fstp st(0)
 fld dword ptr [eax+0000027c]

 mov ebx,(float)80
 cmp ebx,[eax+0000027c]
 jle _MonPO00

 mov [eax+0000027c],ebx

 fstp st(0)
 fld dword ptr [eax+0000027c]

//Officer Troop Size
_MonPO00:
 cmp dword ptr [iEnableMTS],0
 je _ExitMMO                       // Jump if feature is disabled

 mov ebx,[eax+00000284]
 mov [eax+00000280],ebx

_ExitMMO:
 pop ebx

 fstp dword ptr [eax+0000027C]     // Original code (set MP)
 jmp _BackMMO                      // Back to main code

//========================================= rtw
// TBS - When moving (Troop)
_MonMPT:
 mov [aLast],'_MPT'

 push ecx

 mov ecx,[eax+40]                  // Get pArmy
 test ecx,ecx
 jz _ExitMMT

 mov ecx,[ecx+54]
 cmp ecx,[pPlayer]
 jne _ExitMMT

 cmp dword ptr [iEnableMMP],0
 je _MonPT00                       // Jump if feature is disabled

 xor ecx,ecx
 mov [ebp+08],ecx                  // value2decrease = 0

 mov ecx,(float)80
 cmp ecx,[eax+0000027c]
 jle _MonPT00

 mov [eax+0000027c],ecx

//Troop Size
_MonPT00:
 cmp dword ptr [iEnableMTS],0
 je _ExitMMT                       // Jump if feature is disabled

 mov ecx,[eax+00000284]
 mov [eax+00000280],ecx

_ExitMMT:
 pop ecx

 fld dword ptr [eax+0000027C]      // Original code (get MP)
 jmp _BackMMT                      // Back to main code

//========================================= rtw
// TBS - Officers and Special Agents (on Detail Window)
_MonOfficerStatus:
 push eax
 push ebx
 push edx
 push edi

 mov edi,eax

 mov ebx,[edi+7c]
 mov ebx,[ebx]
 cmp ebx,[pPlayer]
 jne _ExitMOS

 mov [pOfficer],edi

 cmp dword ptr [iEnableMOS],0
 je _ExitMOS                       // Jump if feature is disabled

 mov edx,[edi+78]
 lea ebx,[edx+28]
 mov ecx,#08

_MonOS00:
 mov eax,[ebx+ecx*4]
 test eax,eax
 jz _MonOS02
 js _MonOS01

 cmp eax,#09
 jge _MonOS02

 mov dword ptr [ebx+ecx*4],#09
 jmp _MonOS02

_MonOS01:
 neg eax
 cmp eax,#09
 jge _MonOS02

 mov eax,#09
 neg eax
 mov [ebx+ecx*4],eax

_MonOS02:
 loop _MonOS00
{
 mov eax,#09
 cmp eax,[edx+000001c0]
 jle _ExitMOS

 mov [edx+000001c0],eax
}
_MonOS03:
 mov [aLast],'_MOS'

 cmp dword ptr [iEnableMMP],0
 je _ExitMOS                       // Jump if feature is disabled

 mov ecx,[edx+0000016c]            // Get pCommanderInfo
 test ecx,ecx
 jz _ExitMOS

 xor eax,eax
 mov [ecx+000000a2],al             // Enable Move Again

 mov eax,[ecx+00000148]            // get specific Maximum MP

 mov [ecx+0000014c],eax
 mov [ecx+00000150],eax
 mov [ecx+000000c4],eax

 mov ebx,[ecx+000000ec]            // Get pCommanderTroop
 test ebx,ebx
 jz _ExitMOS                       // Jump if there is no troop (it's an agent)

 mov [ebx+0000027c],eax            // Troop's MP = Commander's MP

_ExitMOS:
 pop edi
 pop edx
 pop ebx
 pop eax

 mov eax,[eax+78]                  // Original code (get pInfo)
 mov [ebp-4C],eax                  // Original code
 jmp _BackMOS                      // Back to main code

//========================================= rtw
// TBS - Minimum Available Mercs in the Region (on Detail Window)
_MonAvailableMercs:
 push eax
 push ecx
 push esi

 mov esi,eax

 mov ecx,[esi+000000d8]            // get pMerc

 mov eax,[ebp+04]

 cmp eax,ROAM
 jne _ExitMAM

 cmp dword ptr [iEnableMAM],0
 je _ExitMAM                       // Jump if feature is disabled

 mov eax,[ebp+08]                  // Get pArmy
 test eax,eax
 jz _ExitMAM

 mov eax,[eax+54]                  // Get pPlayer
 cmp eax,[pPlayer]
 jne _ExitMAM

 mov eax,3
 mov [esi+000000dc],eax

 cmp eax,[ecx+14]
 jle _MonAM00

 mov [ecx+14],eax

_MonAM00:
 mov eax,(float)3.0
 cmp eax,[ecx+18]
 jle _ExitMAM

 mov [ecx+18],eax                  // Minimum

_ExitMAM:
 pop esi
 pop ecx
 pop eax

 mov eax,[eax+000000D8]            // Original code (get pMerc)
 jmp _BackMAM                      // Back to main code

//========================================= rtw
// TBS - Selected City/Town/Whatever (Status screen)
_MonSelCity:
 push ebx

 mov [pCity],ecx
 test ecx,ecx
 jz _ExitMSC

 mov ebx,[eax+00000194]
 cmp ebx,[pPlayer]
 jne _ExitMSC

 cmp dword ptr [iEnableMTR],0
 je _ExitMSC                       // Jump if feature is disabled

 mov edx,#20
 cmp edx,[eax+0000030c]
 jle _ExitMSC

 mov [eax+0000030c],edx

_ExitMSC:
 pop ebx

 mov [eax+3C],ecx                  // Original code (Set pCity)
 mov eax,[ebp+0C]                  // Original code
 jmp _BackMSC                      // Back to main code

//========================================= rtw
// TBS - Construction (during turn)
_MonConstruction:
 cmp dword ptr [iEnableMCN],0
 je _ExitMCN                       // Jump if feature is disabled

 mov ecx,[ebp-50]
 mov ecx,[ecx+0c]
 test ecx,ecx
 jz _ExitMCN

 mov ecx,[ecx+00000194]
 cmp ecx,[pPlayer]
 jne _ExitMCN

 mov eax,[ebp-50]
 mov ecx,[eax+20]                  // #Turns Needed
 dec ecx
 mov [eax+24],ecx                  // #Turns already passed (needed - 1)

_ExitMCN:
 mov eax,[ebp-50]                  // Original code (get pConst)
 mov ecx,[ebp-50]                  // Original code (get pConst)
 jmp _BackMCN                      // Back to main code

//========================================= rtw
// TBS - on changing
_MonPublicOrder:
 push ebx

 mov ebx,[ecx]                     // pTown

 mov ebx,[ebx+00000194]
 cmp ebx,[pPlayer]
 jne _ExitCPO

 cmp dword ptr [iEnableMPO],0
 je _ExitCPO                       // Jump if feature is disabled

 mov ebx,#300
 cmp ebx,eax
 jle _ExitCPO

 mov eax,ebx

_ExitCPO:
 pop ebx

 mov [ecx+000000AC],eax            // Original code
 jmp _BackCPO                      // Back to main code

//=========================================
 db '================================&gt;'
 db 'CE6.4 Script by Recifense 100514'
//=========================================
// Variables
iEnableGMD:
 dd 0
iEnableMUS:
 dd 0
iEnableMSU:
 dd 0
iEnableMAO:
 dd 0
iEnableMMG:
 dd 0
iEnableMMP:
 dd 0
iEnableMTS:
 dd 0
iEnableMOS:
 dd 0
iEnableMCN:
 dd 0
iEnableMAM:
 dd 0
iEnableMPO:
 dd 0
iEnableMTR:
 dd 0
iID:
 dd #99
iMAUC:
 dd MyCode
pUnit:
 dd 0
pCity:
 dd 0
pOfficer:
 dd 0
pPlayer:
 dd MyCode
aLast:
 db 'CE64'
iCount:
 dd 0

//=========================================
// Hacking Points
MHID:
 jmp _MonHumanID
 nop
_BackMHI:

MOBE:
 jmp _MonBattleEnd
 nop
 nop
_BackMBE:

GMDA:
 jmp _GodModeA
 nop
_BackGMA:

GMDS:
 jmp _GodModeS
 db 90 90 90 90
_BackGMS:

GMDC:
 jmp _GodModeC
 nop
_BackGMC:

GMDK:
 jmp _GodModeK
 nop
_BackGMK:

GMDR:
 jmp _GodModeR
 nop
 nop
 nop
 nop
_BackGMR:

MOUS:
 jmp _MonUnitStamina
 nop
 nop
_BackMUS:

MOAC:
 jmp _MonAmmoC
 nop
_BackMAC:

MOAT:
 jmp _MonAmmoT
 nop
_BackMAT:

//-------------------
MHPR:
 jmp _MonHumanPlayer
 nop
_BackMHP:

MMPA:
 jmp _MonMPA
 nop
_BackMMA:

MMPO:
 jmp _MonMPO
 nop
_BackMMO:

MMPT:
 jmp _MonMPT
 nop
_BackMMT:

MOOS:
 jmp _MonOfficerStatus
 nop
_BackMOS:

MOAM:
 jmp _MonAvailableMercs
 nop
_BackMAM:

MOSC:
 jmp _MonSelCity
 nop
_BackMSC:

MOCN:
 jmp _MonConstruction
 nop
_BackMCN:

MOPO:
 jmp _MonPublicOrder
 nop
_BackCPO:

//=========================================
// Script for Restoring Original Codes
[DISABLE]
//-------------------------RTS:
MHID:
// mov eax,[eax+000000D8]
 db 8b 80 d8 00 00 00

MOBE:
// and dword ptr [eax+00000288],00
 db 83 a0 88 02 00 00 00

GMDA:
// mov eax,[eax+ecx*4]
// mov [ebp-04],eax
 db 8b 04 88 89 45 fc

GMDS:
// push ebp
// mov ebp,esp
// sub esp,00000274
 db 55 8b ec 81 ec 74 02 00 00

GMDC:
// mov eax,[ebp+0C]
// mov eax,[eax+60]
 db 8b 45 0c 8b 40 60

GMDK:
// push ebp
// mov ebp,esp
// sub esp,2C
 db 55 8b ec 83 ec 2c

GMDR:
// push ebp
// mov ebp,esp
// sub esp,00000498
 db 55 8b ec 81 ec 98 04 00 00

MOUS:
// mov [eax+0000025A],cx
 db 66 89 88 5a 02 00 00

MOAC:
// mov [ecx+000003E0],eax
 db 89 81 e0 03 00 00

MOAT:
// mov [ecx+0000095C],eax
 db 89 81 5c 09 00 00

//-------------------------TBS:
MHPR:
// mov eax,[eax+00000504]
 db 8b 80 04 05 00 00

MMPA:
// fld dword ptr [eax+000000C4]
 db d9 80 c4 00 00 00

MMPO:
// fstp dword ptr [eax+0000027C]
 db d9 98 7c 02 00 00

MMPT:
// fld dword ptr [eax+0000027C]
 db d9 80 7c 02 00 00

MOOS:
// mov eax,[eax+78]
// mov [ebp-4C],eax
 db 8b 40 78 89 45 b4

MOAM:
// mov eax,[eax+000000D8]
 db 8b 80 d8 00 00 00

MOSC:
// mov [eax+3C],ecx
// mov eax,[ebp+0C]
 db 89 48 3c 8b 45 0c

MOCN:
// mov eax,[ebp-50]
// mov ecx,[ebp-50]
 db 8b 45 b0 8b 4d b0

MOPO:
// mov [ecx+000000AC],eax
 db 89 81 ac 00 00 00

//=========================================
// Unregistering Symbols
unregistersymbol(MyCode)
unregistersymbol(iEnableGMD)
unregistersymbol(iEnableMUS)
unregistersymbol(iEnableMSU)
unregistersymbol(iEnableMAO)
unregistersymbol(iEnableMMG)
unregistersymbol(iEnableMMP)
unregistersymbol(iEnableMTS)
unregistersymbol(iEnableMOS)
unregistersymbol(iEnableMAM)
unregistersymbol(iEnableMCN)
unregistersymbol(iEnableMTR)
unregistersymbol(pUnit)
unregistersymbol(pCity)
unregistersymbol(pPlayer)
unregistersymbol(pOfficer)
unregistersymbol(aLast)
unregistersymbol(iCount)

//=========================================
dealloc(MyCode)
//============= Scripts End ===============

// ****************************************
// NOTES
// ****************************************
{
}


</AssemblerScript>
      <CheatEntries>
        <CheatEntry>
          <ID>88</ID>
          <Description>"Enable/Disable God Mode ===================&gt;"</Description>
          <DropDownList DescriptionOnly="1" DisplayValueAsItem="1">0:Disabled
1:Enabled
</DropDownList>
          <LastState Value="??" Activated="0" RealAddress="00000000"/>
          <Color>008000</Color>
          <VariableType>4 Bytes</VariableType>
          <Address>iEnableGMD</Address>
          <Hotkeys>
            <Hotkey>
              <Action>Set Value</Action>
              <Keys>
                <Key>17</Key>
                <Key>97</Key>
              </Keys>
              <Value>1</Value>
              <ID>0</ID>
            </Hotkey>
            <Hotkey>
              <Action>Set Value</Action>
              <Keys>
                <Key>17</Key>
                <Key>96</Key>
              </Keys>
              <Value>0</Value>
              <ID>1</ID>
            </Hotkey>
          </Hotkeys>
        </CheatEntry>
        <CheatEntry>
          <ID>99</ID>
          <Description>"Enable/Disable Unlimited Stamina  =============&gt;"</Description>
          <DropDownList DescriptionOnly="1" DisplayValueAsItem="1">0:Disabled
1:Enabled
</DropDownList>
          <LastState Value="??" Activated="0" RealAddress="00000000"/>
          <Color>008000</Color>
          <VariableType>4 Bytes</VariableType>
          <Address>iEnableMUS</Address>
          <Hotkeys>
            <Hotkey>
              <Action>Set Value</Action>
              <Keys>
                <Key>17</Key>
                <Key>97</Key>
              </Keys>
              <Value>1</Value>
              <ID>0</ID>
            </Hotkey>
            <Hotkey>
              <Action>Set Value</Action>
              <Keys>
                <Key>17</Key>
                <Key>96</Key>
              </Keys>
              <Value>0</Value>
              <ID>1</ID>
            </Hotkey>
          </Hotkeys>
        </CheatEntry>
        <CheatEntry>
          <ID>100</ID>
          <Description>"Enable/Disable Stronger Units ================&gt;"</Description>
          <DropDownList DescriptionOnly="1" DisplayValueAsItem="1">0:Disabled
1:Enabled
</DropDownList>
          <LastState Value="??" Activated="0" RealAddress="00000000"/>
          <Color>008000</Color>
          <VariableType>4 Bytes</VariableType>
          <Address>iEnableMSU</Address>
          <Hotkeys>
            <Hotkey>
              <Action>Set Value</Action>
              <Keys>
                <Key>17</Key>
                <Key>45</Key>
              </Keys>
              <Value>1</Value>
              <ID>0</ID>
            </Hotkey>
            <Hotkey>
              <Action>Set Value</Action>
              <Keys>
                <Key>17</Key>
                <Key>46</Key>
              </Keys>
              <Value>0</Value>
              <ID>1</ID>
            </Hotkey>
          </Hotkeys>
        </CheatEntry>
        <CheatEntry>
          <ID>95</ID>
          <Description>"Enable/Disable Unlimited Ammo  ==============&gt;"</Description>
          <DropDownList DescriptionOnly="1" DisplayValueAsItem="1">0:Disabled
1:Enabled
</DropDownList>
          <LastState Value="??" Activated="0" RealAddress="00000000"/>
          <Color>008000</Color>
          <VariableType>4 Bytes</VariableType>
          <Address>iEnableMAO</Address>
          <Hotkeys>
            <Hotkey>
              <Action>Set Value</Action>
              <Keys>
                <Key>17</Key>
                <Key>97</Key>
              </Keys>
              <Value>1</Value>
              <ID>0</ID>
            </Hotkey>
            <Hotkey>
              <Action>Set Value</Action>
              <Keys>
                <Key>17</Key>
                <Key>96</Key>
              </Keys>
              <Value>0</Value>
              <ID>1</ID>
            </Hotkey>
          </Hotkeys>
        </CheatEntry>
        <CheatEntry>
          <ID>97</ID>
          <Description>"Enable/Disable Minimum Gold ================&gt;"</Description>
          <DropDownList DescriptionOnly="1" DisplayValueAsItem="1">0:Disabled
1:Enabled
</DropDownList>
          <LastState Value="??" Activated="0" RealAddress="00000000"/>
          <Color>008000</Color>
          <VariableType>4 Bytes</VariableType>
          <Address>iEnableMMG</Address>
          <Hotkeys>
            <Hotkey>
              <Action>Set Value</Action>
              <Keys>
                <Key>17</Key>
                <Key>36</Key>
              </Keys>
              <Value>1</Value>
              <ID>0</ID>
            </Hotkey>
            <Hotkey>
              <Action>Set Value</Action>
              <Keys>
                <Key>17</Key>
                <Key>35</Key>
              </Keys>
              <Value>0</Value>
              <ID>1</ID>
            </Hotkey>
          </Hotkeys>
        </CheatEntry>
        <CheatEntry>
          <ID>96</ID>
          <Description>"Enable/Disable Unlimited Movement Points  =====&gt;"</Description>
          <DropDownList DescriptionOnly="1" DisplayValueAsItem="1">0:Disabled
1:Enabled
</DropDownList>
          <LastState Value="??" Activated="0" RealAddress="00000000"/>
          <Color>008000</Color>
          <VariableType>4 Bytes</VariableType>
          <Address>iEnableMMP</Address>
          <Hotkeys>
            <Hotkey>
              <Action>Set Value</Action>
              <Keys>
                <Key>17</Key>
                <Key>36</Key>
              </Keys>
              <Value>1</Value>
              <ID>0</ID>
            </Hotkey>
            <Hotkey>
              <Action>Set Value</Action>
              <Keys>
                <Key>17</Key>
                <Key>35</Key>
              </Keys>
              <Value>0</Value>
              <ID>1</ID>
            </Hotkey>
          </Hotkeys>
        </CheatEntry>
        <CheatEntry>
          <ID>98</ID>
          <Description>"Enable/Disable Recover Troop Size ===========&gt;"</Description>
          <DropDownList DescriptionOnly="1" DisplayValueAsItem="1">0:Disabled
1:Enabled
</DropDownList>
          <LastState Value="??" Activated="0" RealAddress="00000000"/>
          <Color>008000</Color>
          <VariableType>4 Bytes</VariableType>
          <Address>iEnableMTS</Address>
          <Hotkeys>
            <Hotkey>
              <Action>Set Value</Action>
              <Keys>
                <Key>17</Key>
                <Key>36</Key>
              </Keys>
              <Value>1</Value>
              <ID>0</ID>
            </Hotkey>
            <Hotkey>
              <Action>Set Value</Action>
              <Keys>
                <Key>17</Key>
                <Key>35</Key>
              </Keys>
              <Value>0</Value>
              <ID>1</ID>
            </Hotkey>
          </Hotkeys>
        </CheatEntry>
        <CheatEntry>
          <ID>102</ID>
          <Description>"Enable/Disable Minimum Existing Attributes  =====&gt;"</Description>
          <DropDownList DescriptionOnly="1" DisplayValueAsItem="1">0:Disabled
1:Enabled
</DropDownList>
          <LastState Value="??" Activated="0" RealAddress="00000000"/>
          <Color>008000</Color>
          <VariableType>4 Bytes</VariableType>
          <Address>iEnableMOS</Address>
          <Hotkeys>
            <Hotkey>
              <Action>Set Value</Action>
              <Keys>
                <Key>17</Key>
                <Key>33</Key>
              </Keys>
              <Value>1</Value>
              <ID>0</ID>
            </Hotkey>
            <Hotkey>
              <Action>Set Value</Action>
              <Keys>
                <Key>17</Key>
                <Key>34</Key>
              </Keys>
              <Value>0</Value>
              <ID>1</ID>
            </Hotkey>
          </Hotkeys>
        </CheatEntry>
        <CheatEntry>
          <ID>101</ID>
          <Description>"Enable/Disable Construction in 1 Day   =========&gt;"</Description>
          <DropDownList DescriptionOnly="1" DisplayValueAsItem="1">0:Disabled
1:Enabled
</DropDownList>
          <LastState Value="??" Activated="0" RealAddress="00000000"/>
          <Color>008000</Color>
          <VariableType>4 Bytes</VariableType>
          <Address>iEnableMCN</Address>
          <Hotkeys>
            <Hotkey>
              <Action>Set Value</Action>
              <Keys>
                <Key>17</Key>
                <Key>36</Key>
              </Keys>
              <Value>1</Value>
              <ID>0</ID>
            </Hotkey>
            <Hotkey>
              <Action>Set Value</Action>
              <Keys>
                <Key>17</Key>
                <Key>35</Key>
              </Keys>
              <Value>0</Value>
              <ID>1</ID>
            </Hotkey>
          </Hotkeys>
        </CheatEntry>
        <CheatEntry>
          <ID>106</ID>
          <Description>"Enable/Disable Min Existing Units for Hire  ======&gt;"</Description>
          <DropDownList DescriptionOnly="1" DisplayValueAsItem="1">0:Disabled
1:Enabled
</DropDownList>
          <LastState Value="??" Activated="0" RealAddress="00000000"/>
          <Color>008000</Color>
          <VariableType>4 Bytes</VariableType>
          <Address>iEnableMAM</Address>
          <Hotkeys>
            <Hotkey>
              <Action>Set Value</Action>
              <Keys>
                <Key>17</Key>
                <Key>36</Key>
              </Keys>
              <Value>1</Value>
              <ID>0</ID>
            </Hotkey>
            <Hotkey>
              <Action>Set Value</Action>
              <Keys>
                <Key>17</Key>
                <Key>35</Key>
              </Keys>
              <Value>0</Value>
              <ID>1</ID>
            </Hotkey>
          </Hotkeys>
        </CheatEntry>
        <CheatEntry>
          <ID>108</ID>
          <Description>"Enable/Disable Minimum Public Order  =========&gt;"</Description>
          <DropDownList DescriptionOnly="1" DisplayValueAsItem="1">0:Disabled
1:Enabled
</DropDownList>
          <LastState Value="??" Activated="0" RealAddress="06B006C8"/>
          <Color>008000</Color>
          <VariableType>4 Bytes</VariableType>
          <Address>iEnableMPO</Address>
          <Hotkeys>
            <Hotkey>
              <Action>Set Value</Action>
              <Keys>
                <Key>17</Key>
                <Key>36</Key>
              </Keys>
              <Value>1</Value>
              <ID>0</ID>
            </Hotkey>
            <Hotkey>
              <Action>Set Value</Action>
              <Keys>
                <Key>17</Key>
                <Key>35</Key>
              </Keys>
              <Value>0</Value>
              <ID>1</ID>
            </Hotkey>
          </Hotkeys>
        </CheatEntry>
        <CheatEntry>
          <ID>107</ID>
          <Description>"Enable/Disable Recruitment in 1 Day ==========&gt;"</Description>
          <DropDownList DescriptionOnly="1" DisplayValueAsItem="1">0:Disabled
1:Enabled
</DropDownList>
          <LastState Value="??" Activated="0" RealAddress="00000000"/>
          <Color>008000</Color>
          <VariableType>4 Bytes</VariableType>
          <Address>iEnableMTR</Address>
          <Hotkeys>
            <Hotkey>
              <Action>Set Value</Action>
              <Keys>
                <Key>17</Key>
                <Key>36</Key>
              </Keys>
              <Value>1</Value>
              <ID>0</ID>
            </Hotkey>
            <Hotkey>
              <Action>Set Value</Action>
              <Keys>
                <Key>17</Key>
                <Key>35</Key>
              </Keys>
              <Value>0</Value>
              <ID>1</ID>
            </Hotkey>
          </Hotkeys>
        </CheatEntry>
        <CheatEntry>
          <ID>103</ID>
          <Description>"============ Selected Town Info ============"</Description>
          <LastState Activated="0" RealAddress="00000000"/>
          <ShowAsHex>1</ShowAsHex>
          <Color>000080</Color>
          <VariableType>String</VariableType>
          <Length>16</Length>
          <Unicode>0</Unicode>
          <ZeroTerminate>1</ZeroTerminate>
          <Address>pCity</Address>
          <Offsets>
            <Offset>0</Offset>
            <Offset>188</Offset>
          </Offsets>
          <CheatEntries>
            <CheatEntry>
              <ID>94</ID>
              <Description>"Current Population ==&gt;"</Description>
              <LastState Value="??" Activated="0" RealAddress="00000000"/>
              <Color>0000FF</Color>
              <VariableType>4 Bytes</VariableType>
              <Address>pCity</Address>
              <Offsets>
                <Offset>1030</Offset>
              </Offsets>
            </CheatEntry>
            <CheatEntry>
              <ID>104</ID>
              <Description>"Current Public Order ==&gt;"</Description>
              <LastState Value="??" Activated="0" RealAddress="00000000"/>
              <Color>0000FF</Color>
              <VariableType>4 Bytes</VariableType>
              <Address>pCity</Address>
              <Offsets>
                <Offset>1098</Offset>
              </Offsets>
            </CheatEntry>
          </CheatEntries>
        </CheatEntry>
      </CheatEntries>
    </CheatEntry>
  </CheatEntries>
  <UserdefinedSymbols>
    <SymbolEntry>
      <Name>iEnableMPO</Name>
      <Address>06B006C8</Address>
    </SymbolEntry>
  </UserdefinedSymbols>
  <Comments>===========================================
 Game Title    : Rome Total War
 Game Version  : 1.51
 Game Sponsor  : Myself and other Guys (via donation)
 Proces Name   : RomeTW.exe
 Script Version: 5.0
 CE Version    : 6.4
 Release date  : 05-Oct-2014
 Author        : Recifense
 History:
 01-Mar-12: First Release (CE6.1)
 27-Jan-13: Modified GM approach + New Features (Script 3.0)
 10-Feb-13: New Features (Script 4.0)
 24-Feb-13: Killing a bug on MOS (Script 4.1)
 05-Oct-14: Release for version 1.51 (Steam) (CE6.4) (S50)
 Features:
 - God Mode                                 [1]
 - Unlimited Ammo                           [2]
   - Arrows
   - Cannons
 - Unlimited Stamina                        [3]
 - Stronger Units                           [4]
   - Charge Bonus  (15)
   - Base Attack  (120)
   - Base Armor   (120)
 - Unlimited Movement Points                [5]  
   - Army
   - Troop
   - Agents
 - Minimum Gold                             [6]
 - Recover Troop Size                       [7]
 - Construction in 1 day                    [8]
 - Pointer to Selected City                 [9]
 - Officers' and Special Agents' Attributes [A]
 - Minimum Available Mercenaries (for hire) [B]
 - Recruitment in 1 Day                     [C]
 - Minimum Public Order                     [D]
===========================================
[1] That's it;
[2] Ammo is no problem and since you have unlimited stamina, keep on firing;
[3] That's it;
[4] When it is on, the enemy may not attack you;
[5] Beware not to be blocked;
[6] The Minimum value is 64000;
[7] When Army/Fleet is moving;
[8] That's it. Valid to all player's setttlements;
[9] It is used on the table;
[A] The existing attributes will be set to a minimum value (9) and XP as well;
[B] On Entering Hire Mercenary screen (Do not hire all troops at once);
[C] On entering a town, its recruitment power is increased;
[D] The minimum value is 300.
===========================================
[USAGE]
1) Run CE64;
2) Run Game;
3) Load the game process "RomeTW.exe" in CE;
4) Load this table and activate it;
5) Change the value to "Enabled" of each cheat you want to use;
6) Game On;
===========================================
[HOTKEYS]
CTRL+Home      = Enable  MG/UMP/RTS/C1D/EUH/PO/R1D cheats;
CTRL+End       = Disable MG/UMP/RTS/C1D/EUH/PO/R1D cheats;
-----------
CTRL+PageUp    = Enable  MEA cheats;
CTRL+PageDown  = Disable MEA cheats;
-----------
CTRL+Insert    = Enable  SU cheat;
CTRL+Delete    = Disable SU cheat;
-----------
CTRL+Numeric 1 = Enable  GM/US/UA cheats;
CTRL+Numeric 0 = Disable GM/US/UA cheats;
===========================================
[ADVICE]
When you can,save the game before starting using table/cheat. So you can always come back in case you don't like the result.
===========================================
[INFO]
Tested on Win 7 64bits
===========================================
Cheers!
</Comments>
</CheatTable>
